"use strict";(self.webpackChunkamis_editor_demo=self.webpackChunkamis_editor_demo||[]).push([[4984],{34984:function(e,t,a){a.r(t),a.d(t,{UserSelectControlRenderer:function(){return h},default:function(){return p}});var r=a(31635),n=a(96540),o=a(32485),i=a.n(o),s=a(5917),l=a(25627),d=a(7309),c=a.n(d),u=a(66283),p=function(e){function t(t){return e.call(this,t)||this}return(0,r.__extends)(t,e),t.prototype.componentWillUnmount=function(){this.unHook&&this.unHook()},t.prototype.onSearch=function(e,t,a){return(0,r.__awaiter)(this,void 0,void 0,function(){var n,o,i,l,d,c,u,p,h;return(0,r.__generator)(this,function(m){switch(m.label){case 0:if(n=this.props,o=n.searchApi,i=n.setLoading,l=n.env,o=(null==a?void 0:a.searchApi)||o,d=(null==a?void 0:a.searchTerm)||this.props.searchTerm||"term",c=(null==a?void 0:a.searchParam)||this.props.searchParam||{},u=(0,r.__assign)(((h={})[d]=e,h),c),!(0,s.Amo)(o,u))return[2,Promise.resolve([])];i(!0),m.label=1;case 1:return m.trys.push([1,,3,4]),[4,l.fetcher(o,u,{cancelExecutor:t,autoAppend:!0})];case 2:return[2,(p=m.sent()).data&&p.data.options||p.data||[]];case 3:return i(!1),[7];case 4:return[2]}})})},t.prototype.deferLoad=function(e,t,a){return(0,r.__awaiter)(this,void 0,void 0,function(){var n,o,i,l,d,c,u;return(0,r.__generator)(this,function(r){switch(r.label){case 0:if(n=this.props,o=n.env,i=n.deferApi,l=n.setLoading,n.formInited,n.addHook,i=(null==a?void 0:a.deferApi)||i,!o||!o.fetcher)throw new Error("fetcher is required");if(d=(0,s.ed2)(e,{}),!(0,s.Amo)(i,d))return[2,Promise.resolve([])];r.label=1;case 1:return r.trys.push([1,,3,4]),[4,o.fetcher(i,d)];case 2:return c=r.sent(),u=c.data&&c.data.options||c.data||[],t&&u.forEach(function(e){e.isRef=!0}),[2,u];case 3:return l(!1),[7];case 4:return[2]}})})},t.prototype.changeValue=function(e){return(0,r.__awaiter)(this,void 0,void 0,function(){var t,a,n,o,i,l,d,u,p,h,m,f;return(0,r.__generator)(this,function(r){switch(r.label){case 0:return t=this.props,a=t.joinValues,n=t.extractValue,o=t.delimiter,i=t.multiple,l=t.valueField,d=t.onChange,u=t.options,t.setOptions,t.data,p=t.dispatchEvent,h=e,m=[],(Array.isArray(e)?e:e?[e]:[]).forEach(function(e){c()(u,function(t){return t[l||"value"]==e[l||"value"]})||m.push(e)}),a?h=i?Array.isArray(e)?e.map(function(e){return e[l||"value"]}).join(o):e?e[l||"value"]:"":h?h[l||"value"]:"":n&&(h=i?Array.isArray(e)?e.map(function(e){return e[l||"value"]}):e?[e[l||"value"]]:[]:h?h[l||"value"]:""),[4,p("change",(0,s.RKM)(this.props,{value:h,options:u,items:u}))];case 1:return(null==(f=r.sent())?void 0:f.prevented)||d(h),[2]}})})},t.prototype.renderStatic=function(){var e=this.props,t=e.selectedOptions,a=e.labelField,r=void 0===a?"label":a,o=e.classnames;return"avatar"===r?t.map(function(e,t){return n.createElement("img",{key:t,className:o("UserSelect-avatar-img"),src:e[r],alt:""})}):t.map(function(e){return e[r]}).join(",")},t.prototype.render=function(){var e=this,t=this.props,a=t.showNav,r=t.navTitle,o=t.searchable,s=t.options,d=t.className,c=(t.style,t.selectedOptions),u=t.tabOptions,p=t.multi,h=t.multiple,m=t.isDep,f=t.isRef,_=t.placeholder,v=t.searchPlaceholder,y=t.tabMode,g=t.data,b=t.displayFields,A=t.labelField,w=t.loadingConfig,S=t.disabled;return null==u||u.forEach(function(t){t.deferLoad=e.deferLoad,t.onChange=e.changeValue,t.onSearch=e.onSearch}),n.createElement("div",{className:i()("UserSelectControl",d)},y?n.createElement(l.nv,{selection:c,tabOptions:u,multiple:h,displayFields:b,onChange:this.changeValue,onSearch:this.onSearch,deferLoad:this.deferLoad,data:g,disabled:S}):n.createElement(l.oq,{loadingConfig:w,showNav:a,navTitle:r,selection:c,options:s,multi:p,multiple:h,searchable:o,placeholder:_,searchPlaceholder:v,deferLoad:this.deferLoad,onChange:this.changeValue,onSearch:this.onSearch,displayFields:b,labelField:A,isDep:m,isRef:f,disabled:S}))},t.defaultProps={showNav:!0},(0,r.__decorate)([s.d6t,(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String,Function,Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"onSearch",null),(0,r.__decorate)([s.d6t,(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object,Boolean,Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"deferLoad",null),(0,r.__decorate)([s.d6t,(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"changeValue",null),(0,r.__decorate)([(0,u.E)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"render",null),t}(n.Component),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),(0,r.__decorate)([(0,s.QqA)({type:"users-select"})],t)}(p)}}]);