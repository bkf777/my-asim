(self.webpackChunkamis_editor_demo=self.webpackChunkamis_editor_demo||[]).push([[3642],{6048:function(e){e.exports=function(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}},6498:function(e,t,n){var r=n(42e3)(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]});e.exports=r},42194:function(e,t,n){var r=n(15389),i=n(6048),o=n(71086);e.exports=function(e,t){return o(e,i(r(t)))}},53642:function(e,t,n){"use strict";n.r(t),n.d(t,{CRUDRenderer:function(){return D},CRUDRendererBase:function(){return O},default:function(){return k}});var r=n(31635),i=n(96540),o=n(2404),a=n.n(o),s=n(71086),l=n.n(s),d=n(42194),c=n.n(d),u=n(6498),p=n.n(u),h=n(5917),v=n(25627),m=n(44383),f=n.n(m),g=n(40961),b=n(90179),y=n.n(b),_=n(7309),C=n.n(_),F=n(50346),S=n(11331),P=n.n(S),I=n(50104),A=n.n(I),T=["selectedChange","columnSort","columnFilter","columnSearch","columnToggled","orderChange","rowClick","rowDbClick","rowMouseEnter","rowMouseLeave","selected"],k=function(e){function t(t){var n=e.call(this,t)||this;n.filterOnEvent=A()(function(e){return c()(e,function(e,t){return!T.includes(t)})}),n.controlRef=n.controlRef.bind(n),n.handleFilterReset=n.handleFilterReset.bind(n),n.handleFilterSubmit=n.handleFilterSubmit.bind(n),n.handleFilterInit=n.handleFilterInit.bind(n),n.handleAction=n.handleAction.bind(n),n.handleBulkAction=n.handleBulkAction.bind(n),n.handleChangePage=n.handleChangePage.bind(n),n.handleBulkGo=n.handleBulkGo.bind(n),n.handleDialogConfirm=n.handleDialogConfirm.bind(n),n.handleDialogClose=n.handleDialogClose.bind(n),n.handleItemChange=n.handleItemChange.bind(n),n.handleSave=n.handleSave.bind(n),n.handleSaveOrder=n.handleSaveOrder.bind(n),n.handleSelect=n.handleSelect.bind(n),n.handleChildPopOverOpen=n.handleChildPopOverOpen.bind(n),n.handleChildPopOverClose=n.handleChildPopOverClose.bind(n),n.search=n.search.bind(n),n.silentSearch=n.silentSearch.bind(n),n.handleQuery=n.handleQuery.bind(n),n.renderHeaderToolbar=n.renderHeaderToolbar.bind(n),n.renderFooterToolbar=n.renderFooterToolbar.bind(n),n.clearSelection=n.clearSelection.bind(n),n.filterItemIndex=n.filterItemIndex.bind(n);var r,i=t.location,o=t.store,a=t.pageField,s=t.perPageField,l=t.syncLocation,d=(t.loadDataOnce,n.getParseQueryOptions(t));return n.mounted=!0,l&&i&&(i.query||i.search)?o.updateQuery((0,h.mAk)(i,d),void 0,a,s):l&&!i&&window.location.search&&o.updateQuery((0,h.mAk)(window.location,d),void 0,a,s),n.props.store.setFilterTogglable(!!n.props.filterTogglable,n.props.filterDefaultVisible),n.props.api&&n.props.store.updateData({items:[]}),n.props.pickerMode&&(r=(0,h.$_G)(n.props))&&n.syncSelectedFromPicker(r),n}return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.props,t=e.store,n=e.autoGenerateFilter,r=e.perPageField;e.columns,this.props.perPage&&!t.query[r||"perPage"]&&t.changePage(t.page,this.props.perPage),(!this.props.filter&&!n||t.filterTogggable&&!t.filterVisible)&&this.handleFilterInit({}),this.parentContainer=this.getClosestParentContainer()},t.prototype.componentDidUpdate=function(e){var t,n,r=this.props,i=e.store;(0,h.TIf)(["toolbar","headerToolbar","footerToolbar","bulkActions"],e,r)&&(this.renderHeaderToolbar=this.renderHeaderToolbar.bind(this),this.renderFooterToolbar=this.renderFooterToolbar.bind(this)),!this.props.pickerMode||a()(n=(0,h.$_G)(this.props),(0,h.$_G)(e))||a()(n,i.selectedItems.concat())||this.syncSelectedFromPicker(n),!!this.props.filterTogglable!=!!e.filterTogglable&&i.setFilterTogglable(!!r.filterTogglable,r.filterDefaultVisible);var o=!1;if(e.syncLocation&&e.location&&e.location.search!==r.location.search&&(i.updateQuery((0,h.mAk)(r.location,this.getParseQueryOptions(r)),void 0,r.pageField,r.perPageField),o=!(!r.api||!(0,h.JQ)(i.query,this.lastQuery,!1))),o);else if(e.api&&r.api&&(0,h.B92)(e.api,r.api,i.fetchCtxOf(e.data,{pageField:e.pageField,perPageField:e.perPageField}),i.fetchCtxOf(r.data,{pageField:r.pageField,perPageField:r.perPageField})))o=!0;else if(!r.api&&(0,h.joH)(r.source)&&r.data!==e.data){var s=(0,h.GvO)(r.source,r.data,"| raw");this.lastData&&this.lastData===s||(i.initFromScope(r.data,r.source,{columns:null!==(t=i.columns)&&void 0!==t?t:r.columns}),this.props.pickerMode&&(n=(0,h.$_G)(this.props))&&this.syncSelectedFromPicker(n),this.lastData=s)}o&&this.search()},t.prototype.componentWillUnmount=function(){var e,t;this.mounted=!1,clearTimeout(this.timer),null===(t=(e=this.filterOnEvent.cache).clear)||void 0===t||t.call(e)},t.prototype.getParseQueryOptions=function(e){var t,n=e.parsePrimitiveQuery;return{parsePrimitive:!!((0,h.Gvm)(n)?null==n?void 0:n.enable:n),primitiveTypes:null!==(t=null==n?void 0:n.types)&&void 0!==t?t:["boolean"]}},t.prototype.getClosestParentContainer=function(){var e=(0,g.findDOMNode)(this);return null==e?void 0:e.closest("[role=dialog]")},t.prototype.controlRef=function(e){for(;e&&e.getWrappedInstance;)e=e.getWrappedInstance();this.control=e},t.prototype.handleAction=function(e,t,n,i,o){var a=this;void 0===i&&(i=!1);var s=this.props,l=s.onAction,d=s.store,c=s.messages,u=s.pickerMode,p=s.env,v=(s.pageField,s.stopAutoRefreshWhenModalIsOpen);if(!d.loading){if("dialog"===t.actionType){d.setCurrentAction(t,this.props.resolveDefinitions);var m=n.index,f=d.items.length;return v&&clearTimeout(this.timer),new Promise(function(e){d.openDialog(n,{hasNext:m<f-1,nextIndex:m+1,hasPrev:m>0,prevIndex:m-1,index:m},function(n,r){var i;null===(i=t.callback)||void 0===i||i.call(t,n,r),e({confirmed:n,value:r})},o||a.context)})}if("ajax"===t.actionType){d.setCurrentAction(t,this.props.resolveDefinitions);var g=n,b=t.redirect&&(0,h.pbD)(t.redirect,g);if(b&&t.blank&&p.jumpTo(b,t,g),!(0,h.Amo)(t.api,g))return;return d.saveRemote(t.api,g,{successMessage:t.messages&&t.messages.success||c&&c.saveSuccess,errorMessage:t.messages&&t.messages.failed||c&&c.saveFailed}).then(function(e){return(0,r.__awaiter)(a,void 0,void 0,function(){var i,o;return(0,r.__generator)(this,function(r){switch(r.label){case 0:return i=(0,h.ed2)(n,e),t.feedback&&(0,h.zNq)(t.feedback,i)?[4,this.openFeedback(t.feedback,i)]:[3,2];case 1:r.sent(),v&&clearTimeout(this.timer),r.label=2;case 2:return(o=t.redirect&&(0,h.pbD)(t.redirect,i))&&!t.blank&&p.jumpTo(o,t,i),t.reload?this.reloadTarget((0,h.Wvn)(t.reload,i),i):!o&&this.search(void 0,void 0,!0,!0),t.close&&this.closeTarget(t.close),[2]}})})}).catch(function(e){if(i||t.countDown)throw e})}if("reload"!==t.actionType||t.target){if(u&&("confirm"===t.actionType||"submit"===t.actionType))return d.setCurrentAction(t,this.props.resolveDefinitions),Promise.resolve({items:d.selectedItems.concat()});if(t.onClick){d.setCurrentAction(t,this.props.resolveDefinitions);var y=t.onClick;"string"==typeof y&&(y=(0,h.sce)(y,"event","props","data")),y&&y(e,this.props,n)}else l(e,t,n,i,o||this.context)}else this.reload()}},t.prototype.handleBulkAction=function(e,t,n,i){var o,a=this,s=this.props,l=s.store,d=s.primaryField,c=s.onAction,u=s.messages,p=s.pageField,v=s.stopAutoRefreshWhenModalIsOpen,m=s.env;if(e.length||!1===i.requireSelected){var f=e.map(function(e){return e.hasOwnProperty(d)?e[d]:null}).filter(function(e){return e}).join(","),g=(0,h.Rn2)([l.mergedData,{event:n},(0,r.__assign)((0,r.__assign)((0,r.__assign)({},e[0]),l.eventContext),{currentPageData:((null===(o=l.mergedData)||void 0===o?void 0:o.items)||[]).concat(),rows:e,items:e,ids:f})]),b=function(){if("dialog"===i.actionType)return a.handleAction(n,(0,r.__assign)((0,r.__assign)({},i),{__from:"bulkAction"}),g);"ajax"===i.actionType?(0,h.Amo)(i.api,g)&&l.saveRemote(i.api,g,{successMessage:i.messages&&i.messages.success||u&&u.saveSuccess,errorMessage:i.messages&&i.messages.failed||u&&u.saveFailed}).then(function(e){return(0,r.__awaiter)(a,void 0,void 0,function(){var t,n,o;return(0,r.__generator)(this,function(r){switch(r.label){case 0:return t=(0,h.ed2)(g,e),i.feedback&&(0,h.zNq)(i.feedback,t)?[4,this.openFeedback(i.feedback,t)]:[3,2];case 1:r.sent(),v&&clearTimeout(this.timer),r.label=2;case 2:return i.reload?this.reloadTarget((0,h.Wvn)(i.reload,t),t):this.search(((o={})[p||"page"]=1,o),void 0,!0,!0),i.close&&this.closeTarget(i.close),(n=i.redirect&&(0,h.pbD)(i.redirect,t))&&m.jumpTo(n,i,t),[2]}})})}).catch(function(){return null}):c&&c(n,i,g,!1,a.context)},y="";!i.ignoreConfirm&&i.confirmText&&m.confirm&&(y=(0,h.pbD)(i.confirmText,g))?m.confirm(y,(0,h.pbD)(i.confirmTitle,g)||void 0).then(function(e){return e&&b()}):b()}},t.prototype.handleItemAction=function(e,t){this.doAction(e,t)},t.prototype.handleFilterInit=function(e){var t,n=this.props,i=n.defaultParams,o=n.columns,a=n.matchFunc,s=n.store,l=n.orderBy,d=n.orderDir,c=(n.dispatchEvent,(0,r.__assign)({},i));l&&(c.orderBy=l,c.orderDir=d||"asc"),this.handleFilterSubmit((0,r.__assign)((0,r.__assign)((0,r.__assign)({},c),e),s.query),!1,!0,!1!==this.props.initFetch,!0),s.setPristineQuery();var u,p=this.props,v=p.pickerMode,m=p.options;v&&(s.initFromScope({items:m||[]},"${items}",{columns:null!==(t=s.columns)&&void 0!==t?t:o,matchFunc:a}),(u=(0,h.$_G)(this.props))&&this.syncSelectedFromPicker(u))},t.prototype.handleFilterReset=function(e,t){var n=this.props,i=n.store,o=n.syncLocation,a=n.env,s=n.pageField,l=n.perPageField,d={};Object.keys(e).forEach(function(e){return d[e]=""}),i.updateQuery((0,r.__assign)((0,r.__assign)({},d),i.pristineQuery),o&&a&&a.updateLocation?function(e){return a.updateLocation(e)}:void 0,s,l,!0),this.lastQuery=i.query,(null==t?void 0:t.actionType)&&["reset-and-submit","clear-and-submit","submit"].includes(t.actionType)||this.search()},t.prototype.handleFilterSubmit=function(e,t,n,i,o){var a,s,d;void 0===t&&(t=!0),void 0===n&&(n=!1),void 0===i&&(i=!0),void 0===o&&(o=!1);var c=this.props,u=c.store,p=c.syncLocation,v=c.env,m=c.pageField,f=c.perPageField,g=c.loadDataOnceFetchOnFilter,b=c.parsePrimitiveQuery,y=this.getParseQueryOptions(this.props);e=(0,r.__assign)((0,r.__assign)({},e),l()(null!==(d=null===(s=null==e?void 0:e.__super)||void 0===s?void 0:s.diff)&&void 0!==d?d:{},function(e){return void 0===e})),e=p?(0,h.gji)((0,h.Eqn)(e,void 0,!0)):e,b&&(e=(0,h.kCf)(e,y)),u.updateQuery((0,r.__assign)((0,r.__assign)({},e),((a={})[m||"page"]=t?1:u.page,a)),p&&v&&v.updateLocation?function(e){return v.updateLocation(e,n)}:void 0,m,f),this.lastQuery=u.query,i&&this.search(void 0,void 0,void 0,!1!==g,o)},t.prototype.handleBulkGo=function(e,t,n){var r=this,i=this.props.store.selectedAction,o=this.props.env,a="";return i.confirmText&&(a=(0,h.pbD)(i.confirmText,this.props.store.mergedData))?o.confirm(a).then(function(o){return o&&r.handleBulkAction(e,t,n,i)}):this.handleBulkAction(e,t,n,i)},t.prototype.handleDialogConfirm=function(e,t,n,i){var o,a,s,l,d=this.props,c=d.store,u=d.pageField,p=d.stopAutoRefreshWhenModalIsOpen,v=d.interval,m=d.silentPolling,f=d.env;c.closeDialog(!0,e);var g=c.action;if(p&&v&&(this.timer=setTimeout(m?this.silentSearch:this.search,Math.max(v,1e3))),"next"===t.actionType&&"number"==typeof n.nextIndex&&c.data.items[n.nextIndex])return this.handleAction(void 0,(0,r.__assign)({},g),(0,h.ed2)((0,h.ed2)(c.data,{index:n.nextIndex}),c.data.items[n.nextIndex]));if("prev"===t.actionType&&"number"==typeof n.prevIndex&&c.data.items[n.prevIndex])return this.handleAction(void 0,(0,r.__assign)({},g),(0,h.ed2)((0,h.ed2)(c.data,{index:n.prevIndex}),c.data.items[n.prevIndex]));if(e.length){var b=e[0];n=(0,h.ed2)(n,b);var y=i[0];y&&"form"===y.props.type&&(b&&b.__saved?(null!==(a=t.reload)&&void 0!==a?a:g.reload)||this.search(g.__from?((o={})[u||"page"]=1,o):void 0,void 0,!0,!0):b&&(b.hasOwnProperty("items")&&b.items||b.hasOwnProperty("ids"))&&this.control.bulkUpdate&&this.control.bulkUpdate(b,b.items))}var _=null!==(s=t.reload)&&void 0!==s?s:g.reload;_&&this.reloadTarget((0,h.Wvn)(_,n),n);var C=null!==(l=t.redirect)&&void 0!==l?l:g.redirect;(C=C&&(0,h.pbD)(C,n))&&f.jumpTo(C,g,n)},t.prototype.handleDialogClose=function(e){void 0===e&&(e=!1);var t=this.props,n=t.store,r=t.stopAutoRefreshWhenModalIsOpen,i=t.silentPolling,o=t.interval;n.closeDialog(e),r&&o&&(this.timer=setTimeout(i?this.silentSearch:this.search,Math.max(o,1e3)))},t.prototype.openFeedback=function(e,t){var n=this;return new Promise(function(r){var i=n.props.store;i.setCurrentAction({type:"button",actionType:"dialog",dialog:e},n.props.resolveDefinitions),i.openDialog(t,void 0,function(e){r(e)},n.context)})},t.prototype.search=function(e,t,n,i,o){var a,s,l,d;return void 0===i&&(i=!1),void 0===o&&(o=!1),(0,r.__awaiter)(this,void 0,void 0,function(){var c,u,p,v,m,f,g,b,y,_,C,S,P,I,A,T,k,O,D,x,w,M,R,B,E,N,Q,L,q,U;return(0,r.__generator)(this,function(W){switch(W.label){case 0:return c=this.props,u=c.store,p=c.api,v=c.messages,m=c.pageField,f=c.perPageField,g=c.interval,b=c.stopAutoRefreshWhen,y=c.stopAutoRefreshWhenModalIsOpen,_=c.silentPolling,C=c.syncLocation,S=c.syncResponse2Query,P=c.pickerMode,I=c.env,A=c.loadDataOnce,T=c.loadDataOnceFetchOnFilter,k=c.source,O=c.columns,D=c.dispatchEvent,n&&!P&&u.resetSelection(),x="",e&&"string"==typeof e.loadDataMode&&(x="load-more",delete e.loadDataMode),clearTimeout(this.timer),e&&u.updateQuery(e,!x&&C&&I&&I.updateLocation?I.updateLocation:void 0,m,f),this.lastQuery=u.query,w=(0,h.ed2)(u.data,u.query),M=(null===(a=this.props)||void 0===a?void 0:a.matchFunc)&&"string"==typeof this.props.matchFunc?(0,h.sce)(this.props.matchFunc,"items","itemsRaw","options"):void 0,(0,h.Amo)(p,w)?[4,u.fetchInitData(p,w,{successMessage:v&&v.fetchSuccess,errorMessage:v&&v.fetchFailed,autoAppend:!0,forceReload:i,loadDataOnce:A,source:k,silent:t,pageField:m,perPageField:f,loadDataMode:x,syncResponse2Query:S,columns:null!==(s=u.columns)&&void 0!==s?s:O,matchFunc:M,filterOnAllColumns:!1===T})]:[3,8];case 1:return R=W.sent(),(0,F.isAlive)(u)?(B=u.page,E=u.lastPage,N=u.msg,Q=u.error,o?[4,null==D?void 0:D("fetchInited",(0,h.ed2)(this.props.data,{responseData:(null==R?void 0:R.ok)?null!==(l=u.data)&&void 0!==l?l:{}:R,responseStatus:void 0===(null==R?void 0:R.status)?Q?1:0:null==R?void 0:R.status,responseMsg:N}))]:[3,3]):[2,R];case 2:return(null==(L=W.sent())?void 0:L.prevented)?[2,u.data]:[3,5];case 3:return[4,null==D?void 0:D("research",(0,h.ed2)(this.props.data,{responseData:(null==R?void 0:R.ok)?null!=w?w:{}:R,responseStatus:void 0===(null==R?void 0:R.status)?Q?1:0:null==R?void 0:R.status,responseMsg:N}))];case 4:if(null==(L=W.sent())?void 0:L.prevented)return[2];W.label=5;case 5:return!A&&!u.data.items.length&&!g&&B>1&&E<B?[4,this.search((0,r.__assign)((0,r.__assign)({},u.query),(U={},U[m||"page"]=E,U)),!1,void 0)]:[3,7];case 6:W.sent(),W.label=7;case 7:return(null==R?void 0:R.ok)&&g&&this.mounted&&(!b||!(y&&u.hasModalOpened||(0,h.pgu)(b,(0,h.ed2)(u.data,u.query))))&&(this.timer=setTimeout(_?this.silentSearch.bind(this,void 0,void 0,!0):this.search.bind(this,void 0,void 0,void 0,!0),Math.max(g,1e3))),[3,9];case 8:k&&u.initFromScope(w,k,{columns:null!==(d=u.columns)&&void 0!==d?d:O,matchFunc:M}),W.label=9;case 9:return this.props.pickerMode&&(q=(0,h.$_G)(this.props))&&this.syncSelectedFromPicker(q),[2,u.data]}})})},t.prototype.silentSearch=function(e,t,n){return void 0===n&&(n=!1),this.search(e,!0,t,n)},t.prototype.handleChangePage=function(e,t,n){var i;return(0,r.__awaiter)(this,void 0,void 0,function(){var o,a,s,l,d,c,u,p,h,m,f,b,y,_;return(0,r.__generator)(this,function(r){switch(r.label){case 0:return o=this.props,a=o.store,s=o.syncLocation,l=o.env,d=o.pageField,c=o.perPageField,u=o.pageDirectionField,p=o.autoJumpToTopOnPagerChange,h=o.translate,m=o.api,f=o.loadDataOnce,m&&!f&&(null===(i=this.control)||void 0===i?void 0:i.hasModifiedItems())?[4,(0,v.lJ)(h("CRUD.confirmLeaveUnSavedPage"))]:[3,2];case 1:if(!r.sent())return[2];r.label=2;case 2:return(_={})[d||"page"]=e,b=_,n&&(b[u||"pageDir"]=n),t&&(b[c||"perPage"]=t),a.updateQuery(b,s&&(null==l?void 0:l.updateLocation)?l.updateLocation:void 0,d,c),this.search(void 0,void 0,void 0),p&&this.control&&(this.control.scrollToTop?this.control.scrollToTop():((0,g.findDOMNode)(this.control).scrollIntoView(),(y=window.scrollY)&&window.scroll(0,y))),[2]}})})},t.prototype.syncSelectedFromPicker=function(e){var t=this.props,n=t.store,r=t.primaryField,i=t.strictMode,o=e.map(function(e){var t;return P()(e)||((t={})[r||"id"]=e,e=t),(0,h.cym)(n.items,function(t){return function(e,t){var n=e[r||"id"],o=t[r||"id"];return!!(e===t||n&&(i?n===o:n==o))}(t,e)})||e});this.props.store.setSelectedItems(o)},t.prototype.handleItemChange=function(e,t,n){var r=this.props.store,i="".concat(n).split(".").map(function(e){return parseInt(e,10)}),o=(0,h.Z6D)(r.items,i,1,e);r.replaceItems(o)},t.prototype.handleSave=function(e,t,n,i,o,a){var s=this,l=this.props,d=l.store,c=l.quickSaveApi,u=l.quickSaveItemApi,p=l.primaryField,v=l.env,m=l.messages,f=l.reload,g=l.dispatchEvent;if(Array.isArray(e)){if(!(0,h.Amo)(c))return void(v&&v.alert("CRUD quickSaveApi is required"));var b=(0,h.ed2)(d.data,{rows:e,rowsDiff:t,indexes:n,rowsOrigin:o});return e.length&&e[0].hasOwnProperty(p||"id")&&(b.ids=e.map(function(e){return e[p||"id"]}).join(",")),i&&(b.unModifiedItems=i),d.saveRemote(c,b,{successMessage:m&&m.saveFailed,errorMessage:m&&m.saveSuccess}).then(function(e){return(0,r.__awaiter)(s,void 0,void 0,function(){var t,n,i;return(0,r.__generator)(this,function(r){switch(r.label){case 0:return e?[4,null==g?void 0:g("quickSaveSucc",(0,h.C5M)(b,{result:e}))]:[2];case 1:return(null==(t=r.sent())?void 0:t.prevented)?[2]:[2,(n=null!==(i=null==a?void 0:a.reload)&&void 0!==i?i:f)?this.reloadTarget((0,h.Wvn)(n,b),b):this.search(void 0,void 0,!0,!0)]}})})}).catch(function(e){return(0,r.__awaiter)(s,void 0,void 0,function(){return(0,r.__generator)(this,function(t){switch(t.label){case 0:return[4,null==g?void 0:g("quickSaveFail",(0,h.ed2)(this.props.data,{error:e}))];case 1:return t.sent(),[2]}})})})}if((0,h.Amo)(u)){var y=(0,h.ed2)(d.data,{item:e,modified:t,origin:o}),_=(0,h.ed2)(y,e);return d.saveRemote(u,_).then(function(e){return(0,r.__awaiter)(s,void 0,void 0,function(){var t,n,i;return(0,r.__generator)(this,function(r){switch(r.label){case 0:return e?[4,null==g?void 0:g("quickSaveItemSucc",(0,h.C5M)(y,{result:e}))]:[2];case 1:return(null==(t=r.sent())?void 0:t.prevented)?[2]:[2,(n=null!==(i=null==a?void 0:a.reload)&&void 0!==i?i:f)?this.reloadTarget((0,h.Wvn)(n,y),y):this.search(void 0,void 0,!0,!0)]}})})}).catch(function(e){return(0,r.__awaiter)(s,void 0,void 0,function(){return(0,r.__generator)(this,function(t){switch(t.label){case 0:return(null==a?void 0:a.resetOnFailed)&&this.control.reset(),[4,null==g?void 0:g("quickSaveItemFail",(0,h.ed2)(this.props.data,{error:e}))];case 1:return t.sent(),[2]}})})})}v&&v.alert("CRUD quickSaveItemApi is required!")},t.prototype.handleSaveOrder=function(e,t){var n=this,i=this.props,o=i.store,a=i.saveOrderApi,s=i.orderField,l=i.primaryField,d=i.env,c=i.reload,u=i.dispatchEvent;if(a){var p,v,m=(0,h.ed2)(o.data),g=[],b=l&&t[0]&&t[0].hasOwnProperty(l);if(b||(m.idMap={}),m.insertAfter={},t.forEach(function(n){if(~e.indexOf(n))if(p){var r=b?p[l]:t.indexOf(p);m.insertAfter[r]=m.insertAfter[r]||[],b||(m.idMap[r]=p),m.insertAfter[r].push(b?n[l]:n)}else g.push(n);else p=n,v=v||n}),v&&g.length){var y=b?v[l]:t.indexOf(v);b||(m.idMap[y]=v),m.insertBefore={},m.insertBefore[y]=g.map(function(e){return b?e[l]:e})}else if(g.length){var _=g[0],C=b?_[l]:t.indexOf(_);b||(m.idMap[C]=_),m.insertAfter[C]=g.slice(1).map(function(e){return b?e[l]:e})}if(s){var F=(o.page-1)*o.perPage||0;t=(0,h.X$u)(t,function(e,t,n){var r;return(0,h.C5M)(e,((r={})[s]=(1===n?F:0)+t+1,r))})}if(m.rows=t.concat(),b){var S=function(e){return e.map(function(e){return"".concat(e[l]).concat(Array.isArray(e.children)&&e.children.length?"[".concat(S(e.children),"]"):"")}).join(",")};m.ids=S(t),s&&(m.order=(0,h.X$u)(t,function(e){return f()(e,[l,s,"children"])}))}return(0,h.Amo)(a,m)&&o.saveRemote(a,m).then(function(e){return(0,r.__awaiter)(n,void 0,void 0,function(){var t;return(0,r.__generator)(this,function(n){switch(n.label){case 0:return e?[4,null==u?void 0:u("saveOrderSucc",(0,h.C5M)(m,{result:e}))]:[2];case 1:return(null==(t=n.sent())?void 0:t.prevented)||(c&&this.reloadTarget((0,h.Wvn)(c,m),m),this.search(void 0,void 0,!0,!0)),[2]}})})}).catch(function(e){return(0,r.__awaiter)(n,void 0,void 0,function(){return(0,r.__generator)(this,function(t){switch(t.label){case 0:return[4,null==u?void 0:u("saveOrderFail",(0,h.ed2)(this.props.data,{error:e}))];case 1:return t.sent(),[2]}})})})}d&&d.alert("CRUD saveOrderApi is required!")},t.prototype.handleSelect=function(e,t){var n=this.props,r=n.store,i=n.keepItemSelectionOnPageChange,o=n.primaryField,a=n.multiple,s=n.pickerMode,l=n.strictMode,d=n.onSelect,c=e;if(i&&r.selectedItems.length){var u;u=r.items.length>e.length+t.length?function(e,t){return(e.__pristine||e)===(t.__pristine||t)}:function(e,t){var n=e[o||"id"],r=t[o||"id"];return e===t||n&&(l?n===r:n==r)};var p=e.concat();c=r.selectedItems.map(function(e){var n=p.findIndex(function(t){return u(t,e)});return~n?p.splice(n,1)[0]:(0,h.cym)(t,function(t){return u(t,e)})?null:e}).filter(function(e){return e}).concat(p)}var v=r.items.filter(function(e){return!c.find(function(t){return(t.__pristine||t)===e})}).map(function(e){return t.find(function(t){return t.__pristine===e})||e});s&&!1===a&&c.length>1&&v.push.apply(v,c.splice(0,c.length-1)),r.setSelectedItems(c),r.setUnSelectedItems(v),d&&d(c,v)},t.prototype.handleChildPopOverOpen=function(e){this.props.interval&&e&&~["dialog","drawer"].indexOf(e.mode)&&(this.props.stopAutoRefreshWhenModalIsOpen&&clearTimeout(this.timer),this.props.store.setInnerModalOpened(!0))},t.prototype.handleChildPopOverClose=function(e){var t=this.props,n=t.stopAutoRefreshWhenModalIsOpen,r=t.silentPolling,i=t.interval;e&&~["dialog","drawer"].indexOf(e.mode)&&(this.props.store.setInnerModalOpened(!1),n&&i&&(this.timer=setTimeout(r?this.silentSearch:this.search,Math.max(i,1e3))))},t.prototype.handleQuery=function(e,t,n,i,o){var a,s=this.props,l=s.store,d=s.syncLocation,c=s.env,u=s.pageField,p=s.perPageField,h=s.loadDataOnceFetchOnFilter;return l.updateQuery(i?(0,r.__assign)(((a={})[u||"page"]=1,a),e):e,d&&c&&c.updateLocation?c.updateLocation:void 0,u,p,n),this.search(void 0,void 0,null!=o?o:n,null!=t?t:!0===h)},t.prototype.reload=function(e,t,n,r,i,o){return t?this.receive(t,void 0,i,null==o?void 0:o.resetPage,!0):this.search(void 0,void 0,!0,!0)},t.prototype.receive=function(e,t,n,r,i){return this.handleQuery(e,!0,n,r,i)},t.prototype.reloadTarget=function(e,t){},t.prototype.closeTarget=function(e){},t.prototype.doAction=function(e,t,n,i){var o;return void 0===n&&(n=!1),(0,r.__awaiter)(this,void 0,void 0,function(){var a,s,l;return(0,r.__generator)(this,function(r){switch(r.label){case 0:return a=this.props.store,e.actionType&&["submitQuickEdit","toggleExpanded","setExpanded","initDrag","cancelDrag","selectAll","clearAll"].includes(e.actionType)?[2,null===(o=this.control)||void 0===o?void 0:o.doAction(e,t,n,i)]:[3,1];case 1:return"select"!==e.actionType?[3,3]:[4,(0,h.dBT)(a.items,t,null==i?void 0:i.index,null==i?void 0:i.condition)];case 2:return s=r.sent(),l=a.items.filter(function(e){return!s.includes(e)}),[2,this.handleSelect(s,l)];case 3:return[2,this.handleAction(void 0,e,t,n)]}})})},t.prototype.unSelectItem=function(e,t){var n=this.props.store,r=n.selectedItems.concat(),i=n.unSelectedItems.concat(),o=r.indexOf(e);~o&&i.push.apply(i,r.splice(o,1)),n.setSelectedItems(r),n.setUnSelectedItems(i)},t.prototype.clearSelection=function(){var e=this.props,t=e.store,n=e.itemCheckableOn,i=(0,r.__read)(p()(t.selectedItems,function(e){return!n||(0,h.pgu)(n,e)}),2),o=i[0],a=i[1],s=t.unSelectedItems.concat(o);t.setSelectedItems(a),t.setUnSelectedItems(s)},t.prototype.hasBulkActionsToolbar=function(){var e=this.props,t=e.headerToolbar,n=e.footerToolbar,r=function(e){return~["bulkActions","bulk-actions"].indexOf(e.type||e)};return Array.isArray(t)&&C()(t,r)||Array.isArray(n)&&C()(n,r)},t.prototype.hasBulkActions=function(){var e=this.props,t=e.bulkActions,n=(e.itemActions,e.store);if(!t||!t.length)return!1;var i=[],o=n.mergedData;return t&&t.length&&(i=t.map(function(e){return(0,r.__assign)((0,r.__assign)({},e),(0,h.x_4)(e,o))}).filter(function(e){return!e.hidden&&!1!==e.visible})),i.length},t.prototype.renderBulkActions=function(e){var t,n=this,o=this.props,a=o.bulkActions,s=o.itemActions,l=o.store,d=o.render,c=o.classnames,u=o.primaryField;if(!a||!a.length)return null;var p=l.selectedItems,v=l.unSelectedItems,m=[],f=[],g=(0,h.ed2)(l.mergedData,(0,r.__assign)((0,r.__assign)({currentPageData:((null===(t=l.mergedData)||void 0===t?void 0:t.items)||[]).concat()},l.eventContext),{rows:p.concat(),items:p.concat(),ids:p.map(function(e){return e.hasOwnProperty(u)?e[u]:null}).filter(function(e){return e}).join(",")}));a&&a.length&&(!s||!s.length||p.length>1)&&(m=a.map(function(e){return(0,r.__assign)((0,r.__assign)({},e),(0,h.x_4)(e,g))}).filter(function(e){return!e.hidden&&!1!==e.visible}));var b=(0,h.ed2)(l.data,p.length?p[0]:{});return s&&p.length<=1&&(f=s.map(function(e){return(0,r.__assign)((0,r.__assign)({},e),(0,h.x_4)(e,b))}).filter(function(e){return!e.hidden&&!1!==e.visible})),m.length||f.length?i.createElement("div",{className:c("Crud-actions")},m.map(function(e,t){return d("bulk-action/".concat(t),(0,r.__assign)((0,r.__assign)({},y()(e,["visibleOn","hiddenOn","disabledOn"])),{type:e.type||"button",ignoreConfirm:!0}),{key:"bulk-".concat(t),data:g,disabled:e.disabled||!1!==e.requireSelected&&!p.length,onAction:n.handleBulkAction.bind(n,p.concat(),v.concat())})}),f.map(function(e,t){return d("bulk-action/".concat(t),(0,r.__assign)((0,r.__assign)({},y()(e,["visibleOn","hiddenOn","disabledOn"])),{type:"button"}),{key:"item-".concat(t),data:b,disabled:e.disabled||1!==p.length,onAction:n.handleItemAction.bind(n,e,b)})})):null},t.prototype.renderPagination=function(e){var t=this.props,n=t.store,o=t.render,a=t.classnames,s=t.alwaysShowPagination,l=t.perPageAvailable,d=t.testIdBuilder,c=n.page,u=n.lastPage;if("simple"!==n.mode&&n.lastPage<2&&!s)return null;var p={};if(Array.isArray(l)&&(p.perPageAvailable=l),"string"!=typeof e){Object.assign(p,e);var v=e.showPageInput;p.showPageInput=!0===v||u>9&&null==v,p.total=(0,h.GvO)(e.total,n.data)}else p.showPageInput=u>9;return i.createElement("div",{className:a("Crud-pager")},o("pagination",{type:"pagination",testIdBuilder:null==d?void 0:d.getChild("pagination")},(0,r.__assign)((0,r.__assign)({},p),{activePage:c,lastPage:u,hasNext:n.hasNext,mode:n.mode,perPage:n.perPage,popOverContainer:this.parentContainer,onPageChange:this.handleChangePage})))},t.prototype.renderStatistics=function(){var e=this.props,t=e.store,n=e.classnames,r=e.translate,o=e.alwaysShowPagination;return t.lastPage<=1&&!o?null:i.createElement("div",{className:n("Crud-statistics")},r("CRUD.stat",{page:t.page,lastPage:t.lastPage,total:t.total}))},t.prototype.renderSwitchPerPage=function(e){var t=this,n=this.props,r=n.mobileUI,o=n.store,a=n.perPageAvailable,s=n.classnames,l=n.classPrefix,d=n.translate,c=n.testIdBuilder;if(!e.items.length)return null;var u=r?(a||[5,10,20,50,100]).map(function(e){return{label:e+" 条/页",value:e+""}}):(a||[5,10,20,50,100]).map(function(e){return{label:e,value:e+""}});return i.createElement("div",{className:s("Crud-pageSwitch")},r?null:i.createElement("span",null,d("CRUD.perPage")),i.createElement(v.l6,{classPrefix:l,searchable:!1,placeholder:d("Select.placeholder"),options:u,value:o.perPage+"",onChange:function(e){return t.handleChangePage(1,e.value)},clearable:!1,popOverContainer:this.parentContainer,testIdBuilder:null==c?void 0:c.getChild("perPage")}))},t.prototype.renderLoadMore=function(){var e=this,t=this.props,n=t.store,o=t.classPrefix,a=t.classnames,s=t.translate,l=t.testIdBuilder,d=n.page,c=n.lastPage;return i.createElement("div",{className:a("Crud-loadMore")},i.createElement(v.$n,(0,r.__assign)({disabled:d>=c,disabledTip:s("CRUD.loadMoreDisableTip"),classPrefix:o,onClick:function(){return e.search({page:d+1,loadDataMode:"load-more"})},size:"sm"},null==l?void 0:l.getChild("loadMore").getTestId()),s("CRUD.loadMore")))},t.prototype.renderFilterToggler=function(){var e,t,n,o=this.props,a=o.store,s=o.classnames,l=o.translate,d=o.filterTogglable;if(!a.filterTogggable)return null;var c=P()(d)?(0,r.__assign)({},d):{};return a.filterVisible&&(c.icon=null!==(e=c.activeIcon)&&void 0!==e?e:c.icon,c.label=null!==(t=c.activeLabel)&&void 0!==t?t:c.label),i.createElement("button",{onClick:function(){return a.setFilterVisible(!a.filterVisible)},className:s("Button Button--size-default Button--default",{"is-active":a.filterVisible})},c.icon?i.createElement(v.In,{icon:c.icon,className:"icon m-r-xs"}):!1!==(null==c?void 0:c.icon)?i.createElement(v.In,{icon:"filter",className:"icon m-r-xs"}):null,null!==(n=null==c?void 0:c.label)&&void 0!==n?n:l("CRUD.filter"))},t.prototype.renderExportCSV=function(e){var t=this.props,n=t.store,r=t.classPrefix,o=t.translate,a=t.loadDataOnce,s=e.api,l=e.filename;return i.createElement(v.$n,{classPrefix:r,onClick:function(){return n.exportAsCSV({loadDataOnce:a,api:s,filename:l,data:n.filterData})}},e.label||o("CRUD.exportCSV"))},t.prototype.renderToolbar=function(e,t,n,o){var a=this;if(void 0===t&&(t=0),void 0===n&&(n={}),!e)return null;var s=this.props,l=s.render,d=s.store,c=s.mobileUI,u=s.translate,p=s.testIdBuilder,v=e.type||e;if("bulkActions"===v||"bulk-actions"===v)return this.renderBulkActions(n);if("pagination"===v)return this.renderPagination(e);if("statistics"===v)return this.renderStatistics();if("switch-per-page"===v)return this.renderSwitchPerPage(n);if("load-more"===v)return this.renderLoadMore();if("filter-toggler"===v)return this.renderFilterToggler();if("export-csv"===v)return this.renderExportCSV(e);if("reload"===v){var m={label:"",icon:"fa fa-sync",tooltip:u("reload"),tooltipPlacement:"top",type:"button"};return"object"==typeof e&&(m=(0,r.__assign)((0,r.__assign)({},m),y()(e,["type","align"]))),l("toolbar/".concat(t),m,{onAction:function(){a.reload()}})}if(Array.isArray(e)){var f=e.filter(function(e){return(0,h.zNq)(e,d.toolbarData)}).map(function(e,t){return{dom:a.renderToolbar(e,t,n,o),toolbar:e}}).filter(function(e){return e.dom}),g=f.length,b=this.props.classnames;return g?i.createElement("div",(0,r.__assign)({className:b("Crud-toolbar"),key:t},null==p?void 0:p.getChild("toolbar").getTestId()),f.map(function(e,t){var n=e.toolbar,r=e.dom,o=n.type||n,a=n.align||("pagination"===o?"right":"left");return i.createElement("div",{key:n.id||t,className:b("Crud-toolbar-item",a?"Crud-toolbar-item--".concat(a):"",{"is-mobile":c})},r)})):null}var _=o?o(e,t):void 0;if(void 0!==_)return _;var C=n.$$editable;return l("toolbar/".concat(t),e,{data:d.toolbarData,page:d.page,lastPage:d.lastPage,perPage:d.perPage,total:d.total,onQuery:this.handleQuery,onAction:this.handleAction,onChangePage:this.handleChangePage,onBulkAction:this.handleBulkAction,$$editable:C})},t.prototype.renderHeaderToolbar=function(e,t){var n=this.props,r=n.toolbar,i=n.toolbarInline,o=n.headerToolbar;return r&&(o=Array.isArray(o)?i?o.concat(r):[o,r]:o?[o,r]:r),this.renderToolbar(o||[],0,e,t)},t.prototype.renderFooterToolbar=function(e,t){var n=this.props,r=n.toolbar,i=n.toolbarInline,o=n.footerToolbar;return r&&(o=Array.isArray(o)?i?o.concat(r):[o,r]:o?[o,r]:r),this.renderToolbar(o,0,e,t)},t.prototype.renderTag=function(e,t){var n=this.props,r=n.classnames,o=n.labelField,a=n.labelTpl,s=n.primaryField,l=n.valueField,d=(n.translate,n.env),c=n.itemCheckableOn,u=!c||(0,h.pgu)(c,e);return i.createElement("div",{key:t,className:r("Crud-value",u?"":"is-disabled")},i.createElement("span",{className:r("Crud-valueIcon"),onClick:this.unSelectItem.bind(this,e,t)},"×"),i.createElement("span",{className:r("Crud-valueLabel")},a?i.createElement(v.Ed,{html:(0,h.pbD)(a,e),filterHtml:d.filterHtml}):(0,h.dnO)(e,o||"label")||(0,h.dnO)(e,l||s||"id")))},t.prototype.renderSelection=function(){var e=this,t=this.props,n=t.store,o=t.classPrefix,a=t.classnames,s=(t.labelField,t.labelTpl,t.primaryField,t.valueField,t.translate),l=(t.env,t.popOverContainer),d=t.multiple,c=t.maxTagCount,u=t.overflowTagPopover,p=t.keepItemSelectionOnPageChange;if(!n.selectedItems.length||!p||!1===d)return null;var m=n.selectedItems.length,f=n.selectedItems,g=!1!==d&&(0,h.z09)(c,{start:0,end:m,left:"inclusive",right:"exclusive"});return g&&(f=(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(n.selectedItems.slice(0,c)),!1),[{label:"+ ".concat(m-c," ..."),value:"__overflow_tag__"}],!1)),i.createElement("div",{className:a("Crud-selection")},i.createElement("div",{className:a("Crud-selectionLabel")},s("CRUD.selected",{total:n.selectedItems.length})),f.map(function(t,d){return g&&d===c?i.createElement(v.T_,{key:d,container:l,tooltip:(0,r.__assign)((0,r.__assign)({placement:"top",trigger:"hover",showArrow:!1,offset:[0,-10],tooltipClassName:a("Crud-selection-overflow",null==u?void 0:u.tooltipClassName),title:s("已选项")},y()(u,["children","content","tooltipClassName"])),{children:function(){return i.createElement("div",{className:a("".concat(o,"Crud-selection-overflow-wrapper"))},n.selectedItems.slice(c,m).map(function(t,n){var r=n+c;return e.renderTag(t,r)}))}})},i.createElement("div",{key:d,className:a("Crud-value")},i.createElement("span",{className:a("Crud-valueLabel")},t.label))):e.renderTag(t,d)}),i.createElement("a",{onClick:this.clearSelection,className:a("Crud-selectionClear")},s("clear")))},t.prototype.renderFilter=function(){var e,t=this.props,n=t.store,i=t.render,o=t.classnames,a=t.filter,s=t.translate,l=t.testIdBuilder,d=t.filterCanAccessSuperData,c=void 0===d||d;return a||n.filterTogggable&&!n.filterVisible?i("filter",(0,r.__assign)((0,r.__assign)({title:s("CRUD.filter"),mode:"inline",submitText:s("search")},a),{type:"form",api:null,testIdBuilder:null==l?void 0:l.getChild("filter")}),{key:"filter",panelClassName:o("Crud-filter",a.panelClassName||"Panel--default"),data:n.filterData,onReset:this.handleFilterReset,onSubmit:this.handleFilterSubmit,onInit:this.handleFilterInit,formStore:void 0,canAccessSuperData:null!==(e=null==a?void 0:a.canAccessSuperData)&&void 0!==e?e:c}):null},t.prototype.filterItemIndex=function(e){var t,n=this.props.store,r="".concat(e).split(".").map(function(e){return parseInt(e,10)});if(!Array.isArray(n.data.items))return e;var i=null===(t=n.data.items)||void 0===t?void 0:t[r[0]];return i&&(r[0]=n.items.findIndex(function(e){return(e.__pristine||e)===(i.__pristine||i)})),r.join(".")},t.prototype.filterBodySchema=function(e){return e},t.prototype.renderBody=function(){var e,t=this.props,n=(t.className,t.style,t.bodyClassName),i=t.filter,o=t.render,a=t.store,s=t.mode,l=(t.syncLocation,t.children,t.bulkActions),d=t.pickerMode,c=t.multiple,u=t.strictMode,p=t.valueField,h=t.primaryField,v=(t.value,t.hideQuickSaveBtn),m=t.itemActions,f=t.classnames,g=t.keepItemSelectionOnPageChange,b=t.maxKeepItemSelectionLength,y=t.maxItemSelectionLength,_=(t.onAction,t.popOverContainer),C=(t.translate,t.onQuery,t.autoGenerateFilter),F=(t.onSelect,t.autoFillHeight),S=t.onEvent,P=(t.onSave,t.onSaveOrder,t.onPopOverOpened,t.onPopOverClosed,t.onSearchableFromReset,t.onSearchableFromSubmit,t.onSearchableFromInit,t.headerToolbarRender,t.footerToolbarRender,t.testIdBuilder),I=t.id,A=t.filterCanAccessSuperData,T=void 0===A||A,k=t.selectable,O=void 0!==k&&k,D=(0,r.__rest)(t,["className","style","bodyClassName","filter","render","store","mode","syncLocation","children","bulkActions","pickerMode","multiple","strictMode","valueField","primaryField","value","hideQuickSaveBtn","itemActions","classnames","keepItemSelectionOnPageChange","maxKeepItemSelectionLength","maxItemSelectionLength","onAction","popOverContainer","translate","onQuery","autoGenerateFilter","onSelect","autoFillHeight","onEvent","onSave","onSaveOrder","onPopOverOpened","onPopOverClosed","onSearchableFromReset","onSearchableFromSubmit","onSearchableFromInit","headerToolbarRender","footerToolbarRender","testIdBuilder","id","filterCanAccessSuperData","selectable"]);return o("body",(0,r.__assign)((0,r.__assign)({},this.filterBodySchema(D)),{id:I,onEvent:this.filterOnEvent(S),columns:null!==(e=a.columns)&&void 0!==e?e:D.columns,type:s||"table"}),{key:"body",className:f("Crud-body",n),ref:this.controlRef,autoGenerateFilter:!i&&C,filterCanAccessSuperData:T,autoFillHeight:F,selectable:!!(this.hasBulkActionsToolbar()&&this.hasBulkActions()||d||O),itemActions:m,multiple:void 0===c?!!(l&&l.length>0):c,selected:a.selectedItemsAsArray,strictMode:u,keepItemSelectionOnPageChange:g,maxKeepItemSelectionLength:b,maxItemSelectionLength:y,valueField:p||h,primaryField:h,hideQuickSaveBtn:v,items:a.data.items,fullItems:a.itemsAsArray,query:a.query,orderBy:a.query.orderBy,orderDir:a.query.orderDir,popOverContainer:_,onAction:this.handleAction,onItemChange:this.handleItemChange,onSave:this.handleSave,onSaveOrder:this.handleSaveOrder,onQuery:this.handleQuery,onSelect:this.handleSelect,onPopOverOpened:this.handleChildPopOverOpen,onPopOverClosed:this.handleChildPopOverClose,onSearchableFromReset:this.handleFilterReset,onSearchableFromSubmit:this.handleFilterSubmit,onSearchableFromInit:this.handleFilterInit,headerToolbarRender:this.renderHeaderToolbar,footerToolbarRender:this.renderFooterToolbar,data:a.mergedData,loading:a.loading,host:this,filterItemIndex:this.filterItemIndex,onDbClick:this.props.rowDbClick,testIdBuilder:null==P?void 0:P.getChild("body")})},t.prototype.render=function(){var e=this.props,t=e.className,n=e.style,o=e.render,a=e.store,s=e.classnames,l=(e.translate,e.testIdBuilder),d=e.id;return i.createElement("div",(0,r.__assign)({className:s("Crud",t,{"is-loading":a.loading,"is-mobile":(0,h.FrL)()}),style:n,"data-id":d,"data-role":"container"},null==l?void 0:l.getChild("wrapper").getTestId()),this.renderFilter(),this.renderSelection(),this.renderBody(),o("dialog",(0,r.__assign)((0,r.__assign)({},a.action&&a.action.dialog),{type:"dialog"}),{key:"dialog",data:a.dialogData,onConfirm:this.handleDialogConfirm,onClose:this.handleDialogClose,show:a.dialogOpen}))},t.propsList=["bulkActions","itemActions","mode","orderField","syncLocation","toolbar","toolbarInline","messages","value","options","multiple","valueField","defaultParams","bodyClassName","perPageAvailable","pageField","perPageField","pageDirectionField","hideQuickSaveBtn","autoJumpToTopOnPagerChange","interval","silentPolling","stopAutoRefreshWhen","stopAutoRefreshWhenModalIsOpen","api","affixHeader","columnsTogglable","placeholder","tableClassName","headerClassName","footerClassName","headerToolbar","footerToolbar","filterTogglable","filterDefaultVisible","autoGenerateFilter","syncResponse2Query","keepItemSelectionOnPageChange","labelTpl","labelField","loadDataOnce","loadDataOnceFetchOnFilter","source","header","columns","size","onChange","onInit","onSaved","onSave","onQuery","formStore","autoFillHeight","maxTagCount","overflowTagPopover","parsePrimitiveQuery","matchFunc"],t.defaultProps={toolbarInline:!0,headerToolbar:["bulkActions"],footerToolbar:["statistics","pagination"],primaryField:"id",syncLocation:!0,pageField:"page",perPageField:"perPage",pageDirectionField:"pageDir",hideQuickSaveBtn:!1,autoJumpToTopOnPagerChange:!0,silentPolling:!1,filterTogglable:!1,filterDefaultVisible:!0,loadDataOnce:!1,autoFillHeight:!1,parsePrimitiveQuery:!0},t}(i.Component),O=function(e){function t(t,n){var r=e.call(this,t)||this;return n.registerComponent(r),r}return(0,r.__extends)(t,e),t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),this.context.unRegisterComponent(this)},t.prototype.reload=function(t,n,r,i,o,a){var s,l=this.context;return(null==a?void 0:a.index)||(null==a?void 0:a.condition)?null===(s=this.control)||void 0===s?void 0:s.reload("",n,r,void 0,void 0,a):t?l.reload(n?"".concat(t,"?").concat((0,h.Eqn)(n)):t,r):e.prototype.reload.call(this,t,n,r,i,o,a)},t.prototype.receive=function(t,n,i,o,a){return(0,r.__awaiter)(this,void 0,void 0,function(){var s;return(0,r.__generator)(this,function(r){return s=this.context,n?[2,s.send(n,t)]:[2,e.prototype.receive.call(this,t,void 0,i,o,a)]})})},t.prototype.reloadTarget=function(e,t){this.context.reload(e,t)},t.prototype.closeTarget=function(e){this.context.close(e)},t.prototype.setData=function(e,t,n,i){var o,a,s;return(0,r.__awaiter)(this,void 0,void 0,function(){var l,d,c;return(0,r.__generator)(this,function(u){return l=this.props.store,void 0!==n||void 0!==i?[2,null===(a=null===(o=this.control)||void 0===o?void 0:o.setData)||void 0===a?void 0:a.call(o,e,t,n,i)]:(d=(null==e?void 0:e.total)||(null==e?void 0:e.count),c=null!==(s=e.rows)&&void 0!==s?s:e.items,void 0!==d&&l.updateTotal(parseInt(d,10)),[2,l.updateData((0,r.__assign)((0,r.__assign)({},e),c?{items:c}:{}),void 0,t)])})})},t.prototype.getData=function(){var e=this.props,t=e.store,n=e.data;return t.getData(n)},t.contextType=h.MzX,t}(k),D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),(0,r.__decorate)([(0,h.A49)({type:"crud",storeType:h.wKF.name,isolateScope:!0})],t)}(O)},71086:function(e,t,n){var r=n(34932),i=n(15389),o=n(97420),a=n(83349);e.exports=function(e,t){if(null==e)return{};var n=r(a(e),function(e){return[e]});return t=i(t),o(e,n,function(e,n){return t(e,n[0])})}}}]);