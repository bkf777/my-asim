"use strict";(self.webpackChunkamis_editor_demo=self.webpackChunkamis_editor_demo||[]).push([[3911],{13911:function(e,t,a){a.r(t),a.d(t,{ChainedSelectControlRenderer:function(){return m},default:function(){return v}});var n=a(31635),i=a(96540),s=a(32485),o=a.n(s),l=a(5917),r=a(25627),d=a(66283),c=a(7309),p=a.n(c),u=a(62193),h=a.n(u),v=function(e){function t(t){var a=e.call(this,t)||this;return a.state={stack:[]},a.handleChange=a.handleChange.bind(a),a.loadMore=a.loadMore.bind(a),a}return(0,n.__extends)(t,e),t.prototype.componentDidMount=function(){var e,t;this.props.formInited||!this.props.addHook?this.loadMore():null===(t=(e=this.props).addHook)||void 0===t||t.call(e,this.loadMore,"init")},t.prototype.componentDidUpdate=function(e){var t=this.props;e.options!==t.options?this.setState({stack:[]}):t.formInited&&t.value!==e.value&&this.loadMore()},t.prototype.doAction=function(e,t,a){var n,i,s=this.props,o=s.resetValue,r=s.onChange,d=s.formStore,c=s.store,p=s.name,u=null==e?void 0:e.actionType;if("clear"===u)r("");else if("reset"===u){var h=null!==(i=(0,l.dnO)(null!==(n=null==d?void 0:d.pristine)&&void 0!==n?n:null==c?void 0:c.pristine,p))&&void 0!==i?i:o;r(null!=h?h:"")}},t.prototype.array2value=function(e,t){void 0===t&&(t=!1);var a=this.props,n=a.delimiter,i=a.joinValues,s=a.extractValue,o=a.valueField;return t?i?e.join(n||","):e:i?e.join(n||","):s?e.map(function(e){return e[o||"value"]||e}):e},t.prototype.loadMore=function(){for(var e=this,t=this.props,a=t.value,i=t.delimiter,s=t.onChange,o=t.joinValues,r=t.extractValue,d=t.valueField,c=t.source,p=t.data,u=t.env,v=t.dispatchEvent,m=Array.isArray(a)?a.concat():a&&"string"==typeof a?a.split(i||","):[],f=0,g=this.state.stack.length;f<g&&m[f]&&this.state.stack[f].parentId==(o||r?m[f]:m[f][d||"value"]);)f++;if(m[f]&&u&&(0,l.Amo)(c,p)){var _=o||r?m[f]:m[f][d||"value"],C=this.state.stack.concat();C.splice(f,C.length-f),C.push({parentId:_,loading:!0,options:[]}),this.setState({stack:C},function(){u.fetcher(c,(0,n.__assign)((0,n.__assign)({},p),{value:m,level:f+1,parentId:_,parent:m[f]})).then(function(t){return(0,n.__awaiter)(e,void 0,void 0,function(){var e,i,o,r,c,p,u,g;return(0,n.__generator)(this,function(n){switch(n.label){case 0:return e=this.state.stack.concat(),i=t.data?t.data[d||"value"]:void 0,o=(null===(p=null==t?void 0:t.data)||void 0===p?void 0:p.options)||(null===(u=null==t?void 0:t.data)||void 0===u?void 0:u.items)||(null===(g=null==t?void 0:t.data)||void 0===g?void 0:g.rows)||t.data||[],e.splice(f,e.length-f),void 0===i?[3,2]:(m.splice(f+1,a.length-f-1),m.push(i),r=this.array2value(m,!0),[4,v("change",(0,l.RKM)(this.props,{value:r}))]);case 1:if(null==(c=n.sent())?void 0:c.prevented)return[2];s(r),n.label=2;case 2:return e.push({options:o,parentId:_,loading:!1,visible:Array.isArray(o)&&!h()(o)}),this.setState({stack:e},this.loadMore),[2]}})})}).catch(function(e){!(null==c?void 0:c.silent)&&u.notify("error",e.message)})})}},t.prototype.handleChange=function(e,t){return(0,n.__awaiter)(this,void 0,void 0,function(){var a,i,s,o,r,d,c,p,u,h,v;return(0,n.__generator)(this,function(n){switch(n.label){case 0:return a=this.props,i=a.value,s=a.delimiter,o=a.onChange,r=a.joinValues,a.extractValue,d=a.dispatchEvent,c=a.valueField,a.data,(p=Array.isArray(i)?i.concat():i&&"string"==typeof i?i.split(s||","):[]).splice(e,p.length-e),void 0!==(u=r?t[c||"value"]:t)&&p.push(u),h=this.array2value(p),[4,d("change",(0,l.RKM)(this.props,{value:h}))];case 1:return(null==(v=n.sent())?void 0:v.prevented)||o(h),[2]}})})},t.prototype.reload=function(){var e=this.props.reloadOptions;e&&e()},t.prototype.renderStatic=function(e){void 0===e&&(e="-");var t=this.props,a=t.options,s=void 0===a?[]:a,o=t.labelField,l=t.valueField,r=t.classPrefix,d=t.classnames,c=t.className,u=t.value,h=t.delimiter,v=(0,n.__spreadArray)([{options:s,visible:!0}],(0,n.__read)(this.state.stack||[]),!1),m=Array.isArray(u)?u.concat():u&&"string"==typeof u?u.split(h||","):[];return(null==m?void 0:m.length)>0&&(e=m.map(function(e,t){var a,n=v[t]||{},i=n.options;return!1===n.visible?null:i&&i.length&&null!==(a=(p()(i,function(t){return e===t[l||"value"]})||{})[o||"label"])&&void 0!==a?a:e}).filter(function(e){return null!=e}).join(" > ")),i.createElement("div",{className:d("".concat(r,"SelectStaticControl"),c)},e)},t.prototype.render=function(){var e=this,t=this.props,a=t.options,s=t.classPrefix,d=t.className,c=t.style,p=(t.inline,t.loading),u=t.value,h=t.delimiter,v=(t.joinValues,t.extractValue,t.multiple,t.mobileUI),m=t.env,f=t.testIdBuilder,g=t.popoverClassName,_=(0,n.__rest)(t,["options","classPrefix","className","style","inline","loading","value","delimiter","joinValues","extractValue","multiple","mobileUI","env","testIdBuilder","popoverClassName"]),C=Array.isArray(u)?u.concat():u&&"string"==typeof u?u.split(h||","):[],y=this.props,b=y.themeCss,N=y.id,k=this.state.stack.find(function(e){return e.loading});return i.createElement("div",{className:o()("".concat(s,"ChainedSelectControl"),d)},i.createElement(r.l6,(0,n.__assign)({},_,{mobileUI:v,popOverContainer:v?null==m?void 0:m.getModalContainer:_.popOverContainer||(null==m?void 0:m.getModalContainer),className:o()((0,l.NH8)((0,n.__assign)((0,n.__assign)({},this.props),{name:"chainedSelectControlClassName",id:N,themeCss:b}))),popoverClassName:o()(g,(0,l.NH8)((0,n.__assign)((0,n.__assign)({},this.props),{name:"chainedSelectPopoverClassName",id:N,themeCss:b}))),controlStyle:c,classPrefix:s,key:"base",testIdBuilder:null==f?void 0:f.getChild("base"),options:Array.isArray(a)?a:[],value:C[0],onChange:this.handleChange.bind(this,0),loading:p,inline:!0})),this.state.stack.map(function(t,a){var d=t.options,p=t.loading;return!1===t.visible||p?null:i.createElement(r.l6,(0,n.__assign)({},_,{mobileUI:v,popOverContainer:v?m.getModalContainer:_.popOverContainer||(null==m?void 0:m.getModalContainer),classPrefix:s,key:"x-".concat(a+1),testIdBuilder:null==f?void 0:f.getChild("x-".concat(a+1)),options:Array.isArray(d)?d:[],value:C[a+1],onChange:e.handleChange.bind(e,a+1),inline:!0,controlStyle:c,className:o()((0,l.NH8)((0,n.__assign)((0,n.__assign)({},e.props),{name:"chainedSelectControlClassName",id:N,themeCss:b}))),popoverClassName:o()(g,(0,l.NH8)((0,n.__assign)((0,n.__assign)({},e.props),{name:"chainedSelectPopoverClassName",id:N,themeCss:b})))}))}),k&&i.createElement(r.y$,{size:"sm",className:o()("".concat(s,"ChainedSelectControl-spinner"))}),i.createElement(l.z4D,(0,n.__assign)({},this.props,{config:{themeCss:b,classNames:[{key:"chainedSelectControlClassName",weights:{focused:{suf:".is-opened:not(.is-mobile)"},disabled:{suf:".is-disabled"}}},{key:"chainedSelectPopoverClassName",weights:{default:{suf:" .".concat(s,"Select-option")},hover:{suf:" .".concat(s,"Select-option.is-highlight")},focused:{inner:".".concat(s,"Select-option.is-active")}}}],id:N},env:m})))},t.defaultProps={clearable:!1,searchable:!1,multiple:!0},(0,n.__decorate)([(0,d.E)(),(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",[]),(0,n.__metadata)("design:returntype",void 0)],t.prototype,"render",null),t}(i.Component),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),(0,n.__decorate)([(0,l.QqA)({type:"chained-select",sizeMutable:!1})],t)}(v)}}]);