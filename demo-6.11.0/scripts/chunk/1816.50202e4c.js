"use strict";(self.webpackChunkamis_editor_demo=self.webpackChunkamis_editor_demo||[]).push([[1816],{61816:function(e,t,a){a.r(t),a.d(t,{BaseTransferRenderer:function(){return m},TransferRender:function(){return g},default:function(){return v},getCustomFilterOption:function(){return h}});var n=a(31635),r=a(96540),o=a(7309),l=a.n(o),i=a(44383),s=a.n(i),d=a(50346),u=a(51545),p=a(5917),c=a(25627),_=a(66283),h=function(e){switch(typeof e){case"string":return(0,p.sce)(e,"options","inputValue","option");case"function":return e;default:return null}},m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.reload=function(){var e=this.props.reloadOptions;null==e||e()},t.prototype.handleChange=function(e,t){return(0,n.__awaiter)(this,void 0,void 0,function(){var a,r,o,l,i,s,d,u,c,_,h,m,g,v,y,f,b,C;return(0,n.__generator)(this,function(R){switch(R.label){case 0:return a=this.props,r=a.onChange,o=a.joinValues,l=a.delimiter,i=a.valueField,s=a.extractValue,d=a.options,u=a.dispatchEvent,c=a.setOptions,_=a.selectMode,h=a.deferApi,m=a.deferField,g=void 0===m?"defer":m,v=e,y=d.concat(),Array.isArray(e)?(v=e.map(function(e){var a=(0,p.iXH)(d,(0,p.UjQ)(e[i||"value"],i||"value"),{resolve:(0,p.srN)(i),value:e[i]||"value"});if(a){if(t){var r=(0,p.Jvj)(y,a);y=(0,p.Z6D)(y,a,1,(0,n.__assign)((0,n.__assign)({},r),e))}}else y.push((0,n.__assign)((0,n.__assign)({},e),{visible:!1}));return o||s?e[i||"value"]:e}),o&&(v=v.join(l||","))):e&&(v=o||s?e[i||"value"]:e,(f=(0,p.iXH)(d,(0,p.UjQ)(e[i||"value"],i||"value")))?t&&(b=(0,p.Jvj)(y,f),y=(0,p.Z6D)(y,f,1,(0,n.__assign)((0,n.__assign)({},b),e))):y.push((0,n.__assign)((0,n.__assign)({},e),{visible:!1}))),(!0==!("tree"!==_||!h&&!(0,p.cym)(d,function(e){return e.deferApi||e[g]}))||y.length>d.length||t)&&c(y,!0),[4,u("change",(0,p.RKM)(this.props,{value:v,options:d,items:d}))];case 1:return(null==(C=R.sent())?void 0:C.prevented)||r(v),[2]}})})},t.prototype.option2value=function(e){return e},t.prototype.getResult=function(e){return e.data.options||e.data.items||e.data},t.prototype.handleSearch=function(e,t,a){return(0,n.__awaiter)(this,void 0,void 0,function(){var r,o,i,s,d,c,_,m,g,v,y,f,b,C,R;return(0,n.__generator)(this,function(O){switch(O.label){case 0:if(r=this.props,o=r.searchApi,i=r.options,s=r.labelField,d=r.valueField,c=r.env,_=r.data,m=r.translate,g=r.filterOption,!o)return[3,5];O.label=1;case 1:return O.trys.push([1,3,,4]),[4,c.fetcher(o,(0,p.ed2)(_,(0,n.__assign)({term:e},a||{})),{cancelExecutor:t})];case 2:if(!(v=O.sent()).ok)throw new Error(m(v.msg||"networkError"));if(y=this.getResult(v),!Array.isArray(y))throw new Error(m("CRUD.invalidArray"));return f={},a&&(f={page:v.data.page,perPage:a.perPage,total:v.data.count}),[2,(0,n.__assign)({items:(0,p.X$u)(y,function(e){var t=null,a=e[d||"value"];return Array.isArray(i)&&null!=a&&(t=l()(i,(0,p.UjQ)(a,d)),(null==e?void 0:e.children)&&(t=(0,n.__assign)((0,n.__assign)({},t),{children:e.children}))),t||e})},f)];case 3:return b=O.sent(),c.isCancel(b)||o.silent||c.notify("error",b.message),[2,{items:[]}];case 4:return[3,6];case 5:return e?(C={keys:[s||"label",d||"value"]},g?(R=h(g))?[2,{items:R(i,e,C)}]:(c.notify("error","自定义检索函数不符合要求"),[2,{items:[]}]):[2,{items:(0,p.hVz)(i,function(t,a,n,r){return!!(Array.isArray(t.children)&&t.children.length||(0,u.matchSorter)([t].concat(r),e,{keys:[s||"label",d||"value"],threshold:u.matchSorter.rankings.CONTAINS}).length)},0,!0)}]):[2,{items:i}];case 6:return[2]}})})},t.prototype.handleResultSearch=function(e,t){var a=this.props,n=a.valueField,r=a.labelField,o=(0,p.NhP)(e),l=t[r||"label"],i=t[n||"value"];return o.test(l)||o.test(i)},t.prototype.handlePageChange=function(e,t,a){var r=this.props,o=r.source,l=r.data,i=r.formItem,s=r.onChange,u=(0,p.ed2)(l,(0,n.__assign)({page:null!=e?e:1,perPage:null!=t?t:10},a?{pageDir:a}:{}));i&&(0,d.isAlive)(i)&&((0,p.joH)(o)?i.loadOptionsFromDataScope(o,u,s):(0,p.Amo)(o,u)&&i.loadOptions(o,u,void 0,!1,s,!1))},t.prototype.optionItemRender=function(e,t){var a=this.props,n=a.menuTpl,r=a.render,o=a.data;return r("item/".concat(t.index),n,{data:(0,p.ed2)((0,p.ed2)(o,t),e)})},t.prototype.resultItemRender=function(e,t){var a=this.props,n=a.valueTpl,r=a.render,o=a.data;return r("value/".concat(t.index),n,{onChange:t.onChange,data:(0,p.ed2)((0,p.ed2)(o,t),e)})},t.prototype.renderCell=function(e,t,a,r){var o=this.props,l=o.render,i=o.data,s=o.classnames,d=o.showInvalidMatch;return l("cell/".concat(a,"/").concat(r),(0,n.__assign)({type:"text",className:s({"is-invalid":!!d&&(null==t?void 0:t.__unmatched)})},e),{value:(0,p.FL9)(e.name,t),data:(0,p.ed2)(i,t)})},t.prototype.getRef=function(e){for(;e&&e.getWrappedInstance;)e=e.getWrappedInstance();this.tranferRef=e},t.prototype.onSelectAll=function(e){var t=this.props,a=t.dispatchEvent,n=t.data;a("selectAll",(0,p.ed2)(n,{items:e}))},t.prototype.doAction=function(e,t,a){var n,r,o,l,i,s=this.props,d=s.resetValue,u=s.onChange,c=s.formStore,_=s.store,h=s.name;switch(e.actionType){case"clear":null==u||u("");break;case"reset":null==u||u(null!==(o=null!==(r=(0,p.dnO)(null!==(n=null==c?void 0:c.pristine)&&void 0!==n?n:null==_?void 0:_.pristine,h))&&void 0!==r?r:d)&&void 0!==o?o:"");break;case"selectAll":null===(l=this.tranferRef)||void 0===l||l.selectAll();break;case"clearSearch":null===(i=this.tranferRef)||void 0===i||i.clearSearch(t)}},t.prototype.render=function(){var e,t,a=this.props,o=a.className,l=(a.style,a.classnames),i=a.selectedOptions,d=a.showArrow,u=a.sortable,_=a.selectMode,h=a.columns,m=a.loading,g=a.searchable,v=a.searchResultMode,y=a.searchResultColumns,f=a.deferLoad,b=a.leftMode,C=a.rightMode,R=a.disabled,O=a.selectTitle,A=a.resultTitle,S=a.menuTpl,F=a.valueTpl,w=a.searchPlaceholder,I=a.resultListModeFollowSelect,P=void 0!==I&&I,j=a.resultSearchPlaceholder,T=a.resultSearchable,M=void 0!==T&&T,N=a.statistics,k=a.labelField,x=a.valueField,E=a.virtualThreshold,D=a.itemHeight,B=a.loadingConfig,V=a.showInvalidMatch,U=a.onlyChildren,H=a.mobileUI,L=a.noResultsText,Q=a.pagination,z=a.formItem,X=a.env,J=a.popOverContainer,W=a.data,Z=a.autoCheckChildren,$=void 0===Z||Z,q=a.initiallyOpen,K=void 0===q||q,G=a.testIdBuilder,Y=this.props,ee=Y.options,te=Y.leftOptions,ae=Y.leftDefaultValue;return"associated"===_&&ee&&ee.length&&ee[0].leftOptions&&Array.isArray(ee[0].children)&&(te=ee[0].leftOptions,ae=null!==(e=ee[0].leftDefaultValue)&&void 0!==e?e:ae,ee=ee[0].children),r.createElement("div",{className:l("TransferControl",o)},r.createElement(c.mr,{onlyChildren:U,value:i,options:ee,accumulatedOptions:null!==(t=null==z?void 0:z.accumulatedOptions)&&void 0!==t?t:[],disabled:R,onChange:this.handleChange,option2value:this.option2value,sortable:u,showArrow:d,selectMode:_,searchResultMode:v,searchResultColumns:y,columns:h,onSearch:g?this.handleSearch:void 0,onDeferLoad:f,leftOptions:te,leftMode:b,rightMode:C,cellRender:this.renderCell,selectTitle:O,resultTitle:A,resultListModeFollowSelect:P,onResultSearch:this.handleResultSearch,searchPlaceholder:w,resultSearchable:M,resultSearchPlaceholder:j,statistics:N,labelField:k,valueField:x,optionItemRender:S?this.optionItemRender:void 0,resultItemRender:F?this.resultItemRender:void 0,onSelectAll:this.onSelectAll,onRef:this.getRef,virtualThreshold:E,itemHeight:(0,p.Roz)(D)>0?(0,p.Roz)(D):void 0,loadingConfig:B,showInvalidMatch:V,mobileUI:H,noResultsText:L,pagination:(0,n.__assign)((0,n.__assign)({},s()(Q,["className","layout","perPageAvailable","popOverContainerSelector"])),{enable:(Q&&void 0!==Q.enable?!!("string"==typeof Q.enable?(0,p.pgu)(Q.enable,W):Q.enable):!!(null==z?void 0:z.enableSourcePagination))&&(!_||"list"===_||"table"===_)&&ee.length>0,maxButtons:Number.isInteger(null==Q?void 0:Q.maxButtons)?Q.maxButtons:5,page:null==z?void 0:z.sourcePageNum,perPage:null==z?void 0:z.sourcePerPageNum,total:null==z?void 0:z.sourceTotalNum,popOverContainer:null!=J?J:null==X?void 0:X.getModalContainer}),onPageChange:this.handlePageChange,initiallyOpen:K,autoCheckChildren:$,testIdBuilder:G}),r.createElement(c.y$,{overlay:!0,key:"info",loadingConfig:B,show:m}))},t.defaultProps={multiple:!0},(0,n.__decorate)([p.d6t,(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",[Object,Boolean]),(0,n.__metadata)("design:returntype",Promise)],t.prototype,"handleChange",null),(0,n.__decorate)([p.d6t,(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",[Object]),(0,n.__metadata)("design:returntype",void 0)],t.prototype,"option2value",null),(0,n.__decorate)([p.d6t,(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",[Object]),(0,n.__metadata)("design:returntype",void 0)],t.prototype,"getResult",null),(0,n.__decorate)([p.d6t,(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",[String,Function,Object]),(0,n.__metadata)("design:returntype",Promise)],t.prototype,"handleSearch",null),(0,n.__decorate)([p.d6t,(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",[String,Object]),(0,n.__metadata)("design:returntype",void 0)],t.prototype,"handleResultSearch",null),(0,n.__decorate)([p.d6t,(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",[Number,Number,String]),(0,n.__metadata)("design:returntype",void 0)],t.prototype,"handlePageChange",null),(0,n.__decorate)([p.d6t,(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",[Object,Object]),(0,n.__metadata)("design:returntype",void 0)],t.prototype,"optionItemRender",null),(0,n.__decorate)([p.d6t,(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",[Object,Object]),(0,n.__metadata)("design:returntype",void 0)],t.prototype,"resultItemRender",null),(0,n.__decorate)([p.d6t,(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",[Object,Object,Number,Number]),(0,n.__metadata)("design:returntype",void 0)],t.prototype,"renderCell",null),(0,n.__decorate)([p.d6t,(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",[Object]),(0,n.__metadata)("design:returntype",void 0)],t.prototype,"getRef",null),(0,n.__decorate)([p.d6t,(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",[Array]),(0,n.__metadata)("design:returntype",void 0)],t.prototype,"onSelectAll",null),(0,n.__decorate)([(0,_.E)(),(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",[]),(0,n.__metadata)("design:returntype",void 0)],t.prototype,"render",null),t}(r.Component),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t}(m),v=(0,p.QqA)({type:"transfer"})(g)}}]);