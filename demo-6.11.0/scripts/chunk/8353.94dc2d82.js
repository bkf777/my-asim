"use strict";(self.webpackChunkamis_editor_demo=self.webpackChunkamis_editor_demo||[]).push([[8353],{98353:function(e,t,a){a.r(t),a.d(t,{ComboControlRenderer:function(){return I},KVControlRenderer:function(){return A},KVSControlRenderer:function(){return x},default:function(){return _}});var n=a(31635),r=a(96540),i=a(40961),s=a(88055),o=a.n(s),l=a(5917),d=a(25627),u=a(10246),m=a(7309),c=a.n(m),p=a(50104),h=a.n(p),f=a(50346),g=a(11331),b=a.n(g),v=a(2404),y=a.n(v);function C(e,t){return t.reduce(function(t,a){return t[a]=(0,l.FL9)(a,e),t},{})}var _=function(e){function t(t){var a=e.call(this,t)||this;a.subFormDefaultValues=[],a.keys=[],a.toDispose=[],a.id=(0,l.OsD)(),a.refsMap={},a.makeFormRef=h()(function(e){return function(t){return a.formRef(t,e)}}),a.memoizedFormatValue=h()(function(e,t,a,r,i){return(0,l.ed2)((0,l.C5M)(i,(0,n.__assign)({index:r,__index:r},i)),(0,n.__assign)((0,n.__assign)({},a),Array.isArray(t)?C(i,t):null))},function(e,t,a,n,r){return Array.isArray(t)?JSON.stringify([a,n,r,C(r,t)]):e?JSON.stringify([a,n]):JSON.stringify([a,n,r])}),a.handleChange=a.handleChange.bind(a),a.handleRadioChange=a.handleRadioChange.bind(a),a.handleSingleFormChange=a.handleSingleFormChange.bind(a),a.handleSingleFormInit=a.handleSingleFormInit.bind(a),a.handleFormInit=a.handleFormInit.bind(a),a.handleAction=a.handleAction.bind(a),a.addItem=a.addItem.bind(a),a.deleteItem=a.deleteItem.bind(a),a.dragTipRef=a.dragTipRef.bind(a),a.flush=a.flush.bind(a),a.handleComboTypeChange=a.handleComboTypeChange.bind(a),a.handleSubFormValid=a.handleSubFormValid.bind(a),a.defaultValue=(0,n.__assign)({},t.scaffold);var r=t.store,i=(t.value,t.multiple),s=t.formItem,o=t.addHook;return r.config({multiple:i,minLength:a.resolveVariableProps(t,"minLength"),maxLength:a.resolveVariableProps(t,"maxLength"),length:a.getValueAsArray(t).length}),s&&(0,f.isAlive)(s)&&s.setSubStore(r),o&&a.toDispose.push(o(a.flush,"flush")),a}return(0,n.__extends)(t,e),t.prototype.componentDidUpdate=function(e){var t=this.props;if((0,l.TIf)(["minLength","maxLength","value"],e,t)||this.resolveVariableProps(e,"minLength")!==this.resolveVariableProps(t,"minLength")||this.resolveVariableProps(e,"maxLength")!==this.resolveVariableProps(t,"maxLength")){var a=t.store,r=t.multiple,i=this.getValueAsArray(t);a.config({multiple:r,minLength:this.resolveVariableProps(t,"minLength"),maxLength:this.resolveVariableProps(t,"maxLength"),length:i.length}),a.activeKey>=i.length&&a.setActiveKey(Math.max(0,i.length-1)),t.value!==e.value&&!e.formInited&&this.subFormDefaultValues.length&&(this.subFormDefaultValues=this.subFormDefaultValues.map(function(e,t){return(0,n.__assign)((0,n.__assign)({},e),{values:i[t]})}))}},t.prototype.componentWillUnmount=function(){var e,t,a,n,r=this.props.formItem;r&&(0,f.isAlive)(r)&&r.setSubStore(null),this.toDispose.forEach(function(e){return e()}),this.toDispose=[],null===(t=(e=this.memoizedFormatValue.cache).clear)||void 0===t||t.call(e),null===(n=(a=this.makeFormRef.cache).clear)||void 0===n||n.call(a)},t.prototype.resolveVariableProps=function(e,t){var a={minLength:0,maxLength:1/0},n=e[t];if(!n)return a[t];if("string"==typeof n)if((0,l.joH)(n)){var r=(0,l.GvO)(n,e.data,"| raw");n="number"==typeof r&&r>=0?r:a[t]}else{var i=parseInt(n,10);n=isNaN(i)?a[t]:i}return n},t.prototype.doAction=function(e,t,a,n){var r,i,s,o;void 0===a&&(a=!1);var d=null==e?void 0:e.actionType,u=this.props,m=u.onChange,c=u.resetValue,p=u.formStore,h=u.store,f=u.name;if("addItem"===d)this.addItemValue(null!==(r=null==n?void 0:n.item)&&void 0!==r?r:{});else if("clear"===d)m("");else if("reset"===d){var g=null!==(o=(0,l.dnO)(null!==(i=null==p?void 0:p.pristine)&&void 0!==i?i:null===(s=null==h?void 0:h.parentStore)||void 0===s?void 0:s.pristine,f))&&void 0!==o?o:c;m(null!=g?g:"")}},t.prototype.addItemValue=function(e){var t=this.props,a=t.flat,n=t.joinValues,r=t.addattop,i=t.delimiter,s=t.disabled,o=t.submitOnChange;if(!s){var d=this.getValueAsArray();!0===r?(this.keys.unshift((0,l.OsD)()),d.unshift(e)):(d.push(e),this.keys.push((0,l.OsD)())),a&&n&&(d=d.join(i||",")),this.props.onChange(d,o,!0)}},t.prototype.getValueAsArray=function(e){void 0===e&&(e=this.props);var t=e.flat,a=e.joinValues,n=e.delimiter,r=(e.type,e.formItem,e.getValue());return a&&t&&"string"==typeof r?r.split(n||","):Array.isArray(r)?r.concat():[]},t.prototype.addItemWith=function(e){var t,a,r=this.props,i=r.flat,s=r.joinValues,o=r.addattop,d=r.delimiter,u=r.scaffold,m=r.disabled,c=r.submitOnChange;if(!m){var p=this.getValueAsArray();p.push(i?null!==(a=null!==(t=e.scaffold)&&void 0!==t?t:u)&&void 0!==a?a:"":(0,n.__assign)({},e.scaffold||u)),this.keys.push((0,l.OsD)()),i&&s&&(p=p.join(d||",")),!0===o&&(this.keys.unshift(this.keys.pop()),p.unshift(p.pop())),this.props.onChange(p,c,!0)}},t.prototype.addItem=function(){return(0,n.__awaiter)(this,void 0,void 0,function(){var e,t,a,r,i,s,d,u,m,c,p,h,f;return(0,n.__generator)(this,function(g){switch(g.label){case 0:return e=this.props,t=e.flat,a=e.joinValues,r=e.addattop,i=e.delimiter,s=e.scaffold,d=e.disabled,u=e.submitOnChange,m=e.dispatchEvent,c=e.store,d?[2]:(p=this.getValueAsArray(),[4,m("add",(0,l.RKM)(this.props,{value:t&&a?p.join(i||","):o()(p)}))]);case 1:return(null==(h=g.sent())?void 0:h.prevented)||(p.push(t?null!=s?s:"":(0,n.__assign)({},s)),this.keys.push((0,l.OsD)()),t&&a&&(p=p.join(i||",")),f=this.keys.length-1,!0===r&&(this.keys.unshift(this.keys.pop()),p.unshift(p.pop()),f=0),c.setActiveKey(f),this.props.onChange(p,u,!0)),[2]}})})},t.prototype.deleteItem=function(e){var t,a;return(0,n.__awaiter)(this,void 0,void 0,function(){var r,i,s,d,u,m,c,p,h,f,g,b,v,y,C;return(0,n.__generator)(this,function(n){switch(n.label){case 0:return r=this.props,i=r.flat,s=r.joinValues,d=r.delimiter,u=r.disabled,m=r.deleteApi,c=r.deleteConfirmText,p=r.data,h=r.env,f=r.translate,g=r.dispatchEvent,b=r.submitOnChange,u?[2]:(v=this.getValueAsArray(),y=(0,l.ed2)(p,v[e]),[4,g("delete",(0,l.RKM)(this.props,{key:e,value:i&&s?v.join(d||","):o()(v),item:v[e]}))]);case 1:return(null==(C=n.sent())?void 0:C.prevented)?[2]:(0,l.Amo)(m,y)?[4,h.confirm(c?(0,l.pbD)(c,y):f("deleteConfirm"))]:[3,4];case 2:return n.sent()?[4,h.fetcher(m,y)]:[2];case 3:if(!n.sent().ok)return!(null==m?void 0:m.silent)&&h.notify("error",null!==(a=null===(t=null==m?void 0:m.messages)||void 0===t?void 0:t.failed)&&void 0!==a?a:f("deleteFailed")),[2];n.label=4;case 4:return this.keys.splice(e,1),v.splice(e,1),i&&s&&(v=v.join(d||",")),this.props.onChange(v,b,!0),[2]}})})},t.prototype.handleChange=function(e,t,a){var r,i,s,o,d=a.index,u=this.props,m=u.flat,c=u.store,p=u.joinValues,h=u.delimiter,g=u.disabled,b=u.submitOnChange,v=u.type,y=u.syncFields,C=u.name;if(!g){Array.isArray(y)&&y.forEach(function(t){(null==C?void 0:C.startsWith(t))&&(e=(0,n.__assign)({},e),(0,l.S1)(e,C))});var _=this.getValueAsArray();if(_[d]=m?e.flat:(0,n.__assign)({},e),m&&p&&(_=_.join(h||",")),"input-kv"===v){var I=!1,A={};try{for(var x=(0,n.__values)(_),V=x.next();!V.done;V=x.next())A[(E=V.value).key]?I=!0:A[E.key]=!0}catch(e){r={error:e}}finally{try{V&&!V.done&&(i=x.return)&&i.call(x)}finally{if(r)throw r.error}}I||this.props.onChange(_,b,!0)}else if("input-kvs"===v){I=!1,A={};try{for(var N=(0,n.__values)(_),k=N.next();!k.done;k=N.next()){var E;"_key"in(E=k.value)&&(A[E._key]?I=!0:A[E._key]=!0)}}catch(e){s={error:e}}finally{try{k&&!k.done&&(o=N.return)&&o.call(N)}finally{if(s)throw s.error}}I||this.props.onChange(_,b,!0)}else this.props.onChange(_,b,!0);c.forms.forEach(function(e){return(0,f.isAlive)(e)&&e.items.forEach(function(t){return t.unique&&t.syncOptions(void 0,e.data)})})}},t.prototype.handleRadioChange=function(e,t){var a=t.index,r=t.name,i=t.trueValue,s=void 0===i||i,o=t.falseValue,l=void 0!==o&&o,d=this.props,u=d.onChange,m=d.submitOnChange,c=d.multiple,p=d.disabled;if(c&&!p&&r){var h=this.getValueAsArray();if(Array.isArray(h)&&!(h.length<2)&&b()(h[0]))return h=h.map(function(e,t){var i;return(0,n.__assign)((0,n.__assign)({},e),((i={})[r]=t===a?s:l,i))}),u(h,m,!0),!1}},t.prototype.handleSingleFormChange=function(e){null===this.props.value&&y()(this.defaultValue,e)||this.props.onChange((0,n.__assign)({},e),this.props.submitOnChange,!0)},t.prototype.handleSubFormValid=function(e,t){var a=t.index;this.props.store.setMemberValid(e,a)},t.prototype.handleFormInit=function(e,t){var a,r=t.index,i=this.props,s=i.syncDefaultValue,o=i.flat,d=i.joinValues,u=i.delimiter,m=i.formInited,c=i.onChange,p=i.submitOnChange,h=i.setPrinstineValue,f=i.formItem,g=i.name,b=i.syncFields;if(Array.isArray(b)&&b.forEach(function(t){(null==g?void 0:g.startsWith(t))&&(e=(0,n.__assign)({},e),(0,l.S1)(e,g))}),(null==f?void 0:f.validated)&&(null===(a=this.subForms[r])||void 0===a||a.validate(!0,!1,!1)),this.subFormDefaultValues.push({index:r,values:e,setted:!1}),!1!==s&&this.subFormDefaultValues.length===this.subForms.filter(function(e){return void 0!==e}).length){var v=this.getValueAsArray(),y=!1;this.subFormDefaultValues=this.subFormDefaultValues.map(function(e){var t=e.index,a=e.values,r=e.setted,i=o?a.flat:(0,n.__assign)({},a);return!r&&(0,l.JQ)(v[t],i)&&(v[t]=o?a.flat:(0,n.__assign)({},a),y=!0),{index:t,values:a,setted:!0}}),y&&(o&&d&&(v=v.join(u||",")),m?c(v,p,!0):h(v))}},t.prototype.handleSingleFormInit=function(e){var t=this.props,a=t.syncDefaultValue,r=t.setPrinstineValue,i=t.value,s=t.nullable;!1!==a&&!s&&(0,l.JQ)(i,e)&&r((0,n.__assign)({},e))},t.prototype.handleAction=function(e,t){var a=this.props.onAction;"delete"!==t.actionType?a&&a.apply(null,arguments):void 0!==t.index&&this.deleteItem(t.index)},t.prototype.validate=function(){var e=this,t=this.props,a=t.messages,r=t.nullable,i=t.value,s=t.translate,o=t.store,d=t.flat,u=this.getValueAsArray(),m=this.resolveVariableProps(this.props,"minLength"),c=this.resolveVariableProps(this.props,"maxLength");if(m&&(!Array.isArray(u)||u.length<m))return s(a&&a.minLengthValidateFailed||"Combo.minLength",{minLength:m});if(c&&Array.isArray(u)&&u.length>c)return s(a&&a.maxLengthValidateFailed||"Combo.maxLength",{maxLength:c});if(!r||i){if(u.length){var p=this.subForms;return Promise.all(u.map(function(t,a){return(0,n.__awaiter)(e,void 0,void 0,function(){var e,r,i,s,u,m,c,h,g,b,v,y;return(0,n.__generator)(this,function(C){switch(C.label){case 0:return(e=p[a])?[2,e.validate(!0,!1,!1)]:[3,1];case 1:if(!(r=p[Object.keys(p)[0]]))return[3,10];i=r.props.store,s=!1,C.label=2;case 2:C.trys.push([2,7,8,9]),u=(0,n.__values)(i.items),m=u.next(),C.label=3;case 3:return m.done?[3,6]:(c=m.value,h=(0,f.clone)(c),g=d?t:(0,l.dnO)(t,c.name,!1),c.extraName&&!d&&(g=[(0,l.dnO)(t,c.name,!1),(0,l.dnO)(t,c.extraName,!1)]),h.changeTmpValue(g,"dataChanged"),[4,h.validate(t)]);case 4:if(s=C.sent(),(0,f.destroy)(h),!1===s)return[3,6];C.label=5;case 5:return m=u.next(),[3,3];case 6:return[3,9];case 7:return b=C.sent(),v={error:b},[3,9];case 8:try{m&&!m.done&&(y=u.return)&&y.call(u)}finally{if(v)throw v.error}return[7];case 9:return o.setMemberValid(s,a),[2,s];case 10:return[2]}})})})).then(function(e){if(~e.indexOf(!1))return s(a&&a.validateFailed||"validateFailed")})}return this.subForms.length?Promise.all(this.subForms.map(function(e){return e.validate(!0,!1,!1)})).then(function(e){if(~e.indexOf(!1))return s(a&&a.validateFailed||"validateFailed")}):void 0}},t.prototype.flush=function(){return(0,n.__awaiter)(this,void 0,void 0,function(){return(0,n.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all(this.subForms.map(function(e){return e.flush()}))];case 1:return e.sent(),[2]}})})},t.prototype.dragTipRef=function(e){!this.dragTip&&e?this.initDragging():this.dragTip&&!e&&this.destroyDragging(),this.dragTip=e},t.prototype.initDragging=function(){var e=this,t=this.props.classPrefix,a=this.props.submitOnChange,n=(0,i.findDOMNode)(this);this.sortable=new u.Ay(n.querySelector(".".concat(t,"Combo-items")),{group:"combo-".concat(this.id),animation:150,handle:".".concat(t,"Combo-itemDrager"),ghostClass:"".concat(t,"Combo-item--dragging"),onEnd:function(t){if(t.newIndex!==t.oldIndex){var n=t.to;t.oldIndex<n.childNodes.length-1?n.insertBefore(t.item,n.childNodes[t.oldIndex>t.newIndex?t.oldIndex+1:t.oldIndex]):n.appendChild(t.item);var r=e.props.value;if(Array.isArray(r)){var i=r.concat();i.splice(t.newIndex,0,i.splice(t.oldIndex,1)[0]),e.keys.splice(t.newIndex,0,e.keys.splice(t.oldIndex,1)[0]),e.props.onChange(i,a,!0),e.props.dispatchEvent("dragEnd",(0,l.RKM)(e.props,{item:i[t.newIndex],value:i,index:t.newIndex,oldValue:r,oldIndex:t.oldIndex}))}}}})},t.prototype.destroyDragging=function(){this.sortable&&this.sortable.destroy()},Object.defineProperty(t.prototype,"subForms",{get:function(){var e=this;return Object.keys(this.refsMap).map(function(e){return parseInt(e,10)}).sort().map(function(t){return e.refsMap[t]})},enumerable:!1,configurable:!0}),t.prototype.formRef=function(e,t){if(void 0===t&&(t=0),e){for(;e&&e.getWrappedInstance;)e=e.getWrappedInstance();this.refsMap[t]=e}else this.refsMap[t],this.subFormDefaultValues=this.subFormDefaultValues.filter(function(e){return e.index!==t}),delete this.refsMap[t]},t.prototype.formatValue=function(e,t){void 0===t&&(t=-1);var a=this.props,n=a.flat,r=a.data,i=a.strictMode,s=a.syncFields;return n&&(e={flat:e}),e=e||this.defaultValue,this.memoizedFormatValue(!1!==i,s,e,t,r)},t.prototype.pickCondition=function(e){var t=this.props.conditions;return c()(t,function(t){return t.test&&(0,l.pgu)(t.test,e)})},t.prototype.handleComboTypeChange=function(e,t){var a=this.props,r=a.multiple,i=a.onChange,s=a.value,o=(a.flat,a.submitOnChange),d=this.props.conditions,u=c()(d,function(e){return e.label===t.label});if(u)if(r){var m=this.getValueAsArray();m.splice(e,1,(0,n.__assign)({},(0,l.nd1)(u.scaffold||{},m[e]))),i(m,o,!0)}else i((0,n.__assign)({},(0,l.nd1)(u.scaffold||{},s)),o,!0)},t.prototype.handleTabSelect=function(e){return(0,n.__awaiter)(this,void 0,void 0,function(){var t,a,r,i,s,o,d,u,m;return(0,n.__generator)(this,function(c){switch(c.label){case 0:return t=this.props,a=t.store,r=t.data,i=t.name,s=t.value,o=t.dispatchEvent,d={key:e,item:s[e]},[4,o("tabsChange",(0,l.ed2)(r,i?(0,n.__assign)((0,n.__assign)({},d),(m={},m[i]=s,m)):d))];case 1:return(null==(u=c.sent())?void 0:u.prevented)||a.setActiveKey(e),[2]}})})},t.prototype.setNull=function(e){e.preventDefault(),(0,this.props.onChange)(null),this.subForms.forEach(function(e){e.clearErrors()})},t.prototype.renderPlaceholder=function(){var e=this.props,t=e.placeholder,a=e.translate;return r.createElement("span",{className:"text-muted"},a(t||"placeholder.noData"))},t.prototype.renderTabsMode=function(){var e=this,t=this.props,a=(t.classPrefix,t.classnames),i=t.tabsStyle,s=(t.formClassName,t.render,t.disabled),o=t.store,u=t.flat,m=(t.subFormMode,t.addButtonText,t.addable),c=t.removable,p=t.typeSwitchable,h=t.itemRemovableOn,f=t.delimiter,g=(t.canAccessSuperData,t.addIcon,t.deleteIcon),b=t.tabsLabelTpl,v=t.conditions,y=(t.changeImmediately,t.addBtnText),C=(t.static,t.translate),_=t.testIdBuilder,I=this.props.items,A=this.props.value;u&&"string"==typeof A&&(A=A.split(f||","));var x=!1!==o.removable&&!s&&!1!==c;return Array.isArray(A)||(A=[]),r.createElement(d.tU,{addBtnText:C(y||"add"),className:"ComboTabs",mode:i,activeKey:o.activeKey,onSelect:this.handleTabSelect,testIdBuilder:_,additionBtns:!s&&!1!==m&&o.addable?r.createElement("li",{className:a("Tabs-link ComboTabs-addLink")},this.renderAddBtn()):null},A.map(function(t,i){var s=e.formatValue(t,i),m=null==_?void 0:_.getChild("tab-".concat(i)),c=null,f=void 0;!x||h&&!1===(0,l.pgu)(h,t)||(f=r.createElement("div",(0,n.__assign)({onClick:e.deleteItem.bind(e,i),key:"delete",className:a("Combo-tab-delBtn ".concat(o.removable?"":"is-disabled")),"data-tooltip":C("delete"),"data-position":"bottom"},null==m?void 0:m.getChild("delBtn").getTestId()),g?r.createElement("i",{className:g}):r.createElement(d.In,{icon:"status-close",className:"icon"}))),Array.isArray(v)&&v.length&&(c=e.pickCondition(s),I=c?c.items:void 0);var y=u&&I?[(0,n.__assign)((0,n.__assign)({},I&&I[0]),{name:"flat"})]:I,A=Array.isArray(y)&&y.some(function(e){return e.unique});return e.keys[i]||e.keys.splice(i,0,(0,l.OsD)()),r.createElement(d.oz,{title:(0,l.pbD)(b||C("{{index}}",{index:s.index+1}),s),key:e.keys[i],toolbar:f,eventKey:i,mountOnEnter:!A,unmountOnExit:!1,className:!1===o.memberValidMap[i]?"has-error":"",tabClassName:!1===o.memberValidMap[i]?"has-error":"",testIdBuilder:m},c&&!1!==p?r.createElement("div",{className:a("Combo-itemTag")},r.createElement("label",null,C("Combo.type")),r.createElement(d.l6,{onChange:e.handleComboTypeChange.bind(e,i),options:v.map(function(e){return{label:e.label,value:e.label}}),value:c.label,clearable:!1})):null,r.createElement("div",{className:a("Combo-itemInner")},y?e.renderItems(y,s,i,t):r.createElement(d.pM,{level:"warning",className:"m-b-none"},C("Combo.invalidData"))))}))},t.prototype.renderDelBtn=function(e,t){var a=this;if(this.props.static)return null;var i=this.props,s=(i.classPrefix,i.classnames),o=i.render,u=i.store,m=i.deleteIcon,c=i.translate,p=i.itemRemovableOn,h=i.disabled,f=i.removable,g=i.deleteBtn,b=i.mobileUI,v=i.data,y=i.testIdBuilder,C=null==y?void 0:y.getChild("delete-btn-".concat(t));return!1===u.removable||h||!1===f||p&&!1===(0,l.pgu)(p,e)?null:(0,l.Gvm)(g)?o("delete-btn",(0,n.__assign)((0,n.__assign)({},g),{type:"button",className:s("Combo-delController",g?g.className:""),testIdBuilder:C,onClick:function(e){if(g.onClick){var n=g.onClick;"string"==typeof n&&(n=(0,l.uPQ)(g.onClick,"e","index","props"));var r=n(e,t,a.props);r&&r.then?r.then(function(){a.deleteItem(t)}):a.deleteItem(t)}else a.deleteItem(t)}}),{data:(0,l.C5M)(v,{index:t})}):"string"==typeof g?o("delete-btn",{type:"button",className:s("Combo-delController"),label:g,onClick:this.deleteItem.bind(this,t),testIdBuilder:C}):r.createElement("a",(0,n.__assign)({onClick:this.deleteItem.bind(this,t),key:"delete",className:s("Combo-delBtn ".concat(u.removable?"":"is-disabled")),"data-tooltip":b?null:c("delete"),"data-position":"bottom"},null==C?void 0:C.getTestId()),m?r.createElement("i",{className:m}):r.createElement(d.In,{icon:"status-close",className:"icon"}))},t.prototype.renderAddBtn=function(){var e=this;if(this.props.static)return null;var t=this.props,a=(t.classPrefix,t.classnames),i=t.render,s=t.addButtonClassName,o=t.store,u=t.addButtonText,m=t.addBtn,c=t.addable,p=t.addIcon,h=t.conditions,f=t.translate,g=t.tabsMode,b=t.testIdBuilder,v=Array.isArray(h)&&h.length,y=null==b?void 0:b.getChild("add-button");return r.createElement(r.Fragment,null,o.addable&&!1!==c&&(v?i("add-button",{type:"dropdown-button",icon:p?r.createElement(d.In,{icon:"plus-fine",className:"icon"}):"",label:f(u||"add"),level:"info",size:"sm",closeOnClick:!0,btnClassName:s,testIdBuilder:y},{buttons:null==h?void 0:h.map(function(t){return{label:t.label,onClick:function(a){return e.addItemWith(t),!1}}})}):g?r.createElement("a",{onClick:this.addItem},p?r.createElement(d.In,{icon:"plus-fine",className:"icon"}):null,r.createElement("span",null,f(u||"add"))):(0,l.Gvm)(m)?i("add-button",(0,n.__assign)((0,n.__assign)({},m),{type:"button",testIdBuilder:y,onClick:function(){return e.addItem()}})):r.createElement(d.$n,{className:a("Combo-addBtn",s),onClick:this.addItem,testIdBuilder:y},p?r.createElement(d.In,{icon:"plus-fine",className:"icon"}):null,r.createElement("span",null,f(u||"add")))))},t.prototype.renderMultipe=function(){var e=this;if(this.props.tabsMode)return this.renderTabsMode();var t=this.props,a=(t.classPrefix,t.classnames),i=t.multiLine,s=t.disabled,o=t.flat,u=t.draggable,m=t.draggableTip,c=t.typeSwitchable,p=t.delimiter,h=t.dragIcon,f=t.noBorder,g=t.conditions,b=t.placeholder,v=t.translate,y=t.itemClassName,C=t.itemsWrapperClassName,_=t.static,I=t.mobileUI,A=t.store,x=this.props.items,V=this.props.value;return o&&"string"==typeof V&&(V=V.split(p||",")),r.createElement("div",{className:a("Combo Combo--multi",{"is-mobile":I},i?"Combo--ver":"Combo--hor",f?"Combo--noBorder":"",s?"is-disabled":"",!_&&!s&&u&&Array.isArray(V)&&V.length>1?"is-draggable":"")},r.createElement("div",{className:a("Combo-items",C)},Array.isArray(V)&&V.length?V.map(function(t,i,m){var p=e.renderDelBtn(t,i),f=e.formatValue(t,i),b=null;Array.isArray(g)&&g.length&&(b=e.pickCondition(f),x=b?b.items:void 0);var C=o&&x?[(0,n.__assign)((0,n.__assign)({},x&&x[0]),{name:"flat"})]:x;return e.keys[i]||e.keys.splice(i,1,(0,l.OsD)()),r.createElement("div",{className:a("Combo-item",y,!1===A.memberValidMap[i]?"has-error":""),key:e.keys[i]},!_&&!s&&u&&m.length>1?r.createElement("div",{className:a("Combo-itemDrager")},r.createElement("a",{key:"drag","data-tooltip":v("Combo.dragDropSort"),"data-position":"bottom"},h?r.createElement("i",{className:h}):r.createElement(d.In,{icon:"drag-bar",className:"icon"}))):null,b&&!1!==c?r.createElement("div",{className:a("Combo-itemTag")},r.createElement("label",null,v("Combo.type")),r.createElement(d.l6,{onChange:e.handleComboTypeChange.bind(e,i),options:g.map(function(e){return{label:e.label,value:e.label}}),value:b.label,clearable:!1})):null,r.createElement("div",{className:a("Combo-itemInner")},C?e.renderItems(C,f,i,t):r.createElement(d.pM,{level:"warning",className:"m-b-none"},v("Combo.invalidData"))),p)}):b?r.createElement("div",{className:a("Combo-placeholder")},v(b)):null),_||s?null:r.createElement("div",{className:a("Combo-toolbar")},this.renderAddBtn(),u?r.createElement("span",{className:a("Combo-dragableTip"),ref:this.dragTipRef},Array.isArray(V)&&V.length>1?v(m):""):null))},t.prototype.renderSingle=function(){var e=this.props,t=e.conditions,a=e.classnames,n=e.value,i=e.multiLine,s=e.noBorder,o=e.disabled,u=e.typeSwitchable,m=e.nullable,c=e.translate,p=e.itemClassName,h=e.mobileUI,f=e.store,g=this.props.items,b=(0,l.Gvm)(n)?this.formatValue(n):this.formatValue(this.defaultValue),v=null;return Array.isArray(t)&&t.length&&(g=(v=this.pickCondition(b))?v.items:void 0),r.createElement("div",{className:a("Combo Combo--single",{"is-mobile":h},i?"Combo--ver":"Combo--hor",s?"Combo--noBorder":"",o?"is-disabled":"")},r.createElement("div",{className:a("Combo-item",p,!1===f.memberValidMap[0]?"has-error":"")},v&&!1!==u?r.createElement("div",{className:a("Combo-itemTag")},r.createElement("label",null,c("Combo.type")),r.createElement(d.l6,{onChange:this.handleComboTypeChange.bind(this,0),options:t.map(function(e){return{label:e.label,value:e.label}}),value:v.label,clearable:!1})):null,r.createElement("div",{className:a("Combo-itemInner")},g?this.renderItems(g,b):r.createElement(d.pM,{level:"warning",className:"m-b-none"},c("Combo.invalidData")))),n&&m?r.createElement("a",{className:a("Combo-setNullBtn"),href:"#",onClick:this.setNull},c("clear")):null)},t.prototype.renderItems=function(e,t,a,i){var s=this.props,o=s.classnames,l=s.formClassName,d=s.render,u=s.multiLine,m=s.disabled,c=s.canAccessSuperData,p=s.multiple,h=s.tabsMode,f=s.subFormMode,g=s.subFormHorizontal,b=s.changeImmediately,v=s.lazyLoad,y=(s.translate,s.static),C=s.testIdBuilder,_=s.updatePristineAfterStoreDataReInit,I=Array.isArray(e)?e.map(function(e,t){var r=void 0!==a&&a>=0?"-".concat(a):"",i="item-".concat(e.testid||e.id||t)+r;return(0,n.__assign)((0,n.__assign)({},e),{testIdBuilder:null==C?void 0:C.getChild(i)})}):e;return p?p&&void 0!==a&&a>=0?d("multiple/".concat(a),{type:"form",body:I,wrapperComponent:"div",wrapWithPanel:!1,mode:h||u?f:"row",horizontal:g,className:o("Combo-form",l)},(0,n.__assign)((0,n.__assign)({index:a,disabled:m,static:y,data:t,originData:i,onChange:this.handleChange,onInit:this.handleFormInit,onAction:this.handleAction,onRadioChange:this.handleRadioChange,ref:this.makeFormRef(a),onValidChange:this.handleSubFormValid,canAccessSuperData:c,lazyChange:!b,formLazyChange:!1,value:void 0,formItemValue:void 0,formStore:void 0},h?{}:{lazyLoad:v}),{updatePristineAfterStoreDataReInit:null!=_&&_})):r.createElement(r.Fragment,null):d("single",{type:"form",body:I,wrapperComponent:"div",wrapWithPanel:!1,mode:u?f||"normal":"row",horizontal:g,className:o("Combo-form",l)},{index:0,disabled:m,static:y,data:t,originData:i,onChange:this.handleSingleFormChange,ref:this.makeFormRef(0),onValidChange:this.handleSubFormValid,onInit:this.handleSingleFormInit,canAccessSuperData:c,lazyChange:!b,formLazyChange:!1,value:void 0,formItemValue:void 0,formStore:void 0,updatePristineAfterStoreDataReInit:null!=_&&_})},t.prototype.renderStatic=function(e){return void 0===e&&(e="-"),this.props.render("static-input-kv",{type:"json"},this.props)},t.prototype.render=function(){var e=this.props,t=e.type,a=e.formInited,n=e.multiple,i=e.className,s=(e.style,e.classPrefix,e.classnames),o=e.static,l=e.staticSchema;return o&&(l||["input-kv","input-kvs"].includes(t))?this.renderStatic():a||void 0===a?r.createElement("div",{className:s("ComboControl",i)},n?this.renderMultipe():this.renderSingle()):null},t.defaultProps={minLength:0,maxLength:1/0,multiple:!1,multiLine:!1,addButtonClassName:"",formClassName:"",subFormMode:"normal",draggableTip:"",addButtonText:"add",canAccessSuperData:!1,addIcon:!0,dragIcon:"",deleteIcon:"",tabsMode:!1,tabsStyle:"",placeholder:"placeholder.empty",itemClassName:"",itemsWrapperClassName:""},t.propsList=["minLength","maxLength","multiple","multiLine","addButtonClassName","subFormMode","draggableTip","addButtonText","draggable","scaffold","canAccessSuperData","addIcon","dragIcon","deleteIcon","noBorder","conditions","tabsMode","tabsStyle","lazyLoad","changeImmediately","strictMode","items","conditions","messages","formStore","itemClassName","itemsWrapperClassName"],(0,n.__decorate)([l.d6t,(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",[Number]),(0,n.__metadata)("design:returntype",Promise)],t.prototype,"handleTabSelect",null),(0,n.__decorate)([l.d6t,(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",[Object]),(0,n.__metadata)("design:returntype",void 0)],t.prototype,"setNull",null),t}(r.Component),I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.setData=function(e,t,a,r){return(0,n.__awaiter)(this,void 0,void 0,function(){var t,i,s,o,d,u,m,c;return(0,n.__generator)(this,function(p){switch(p.label){case 0:return t=this.props,i=t.multiple,s=t.onChange,o=t.submitOnChange,i?(d=(0,n.__spreadArray)([],(0,n.__read)(this.getValueAsArray()),!1),u=d.length,void 0===a?[3,1]:(String(a).split(",").forEach(function(t){var a=Number(t);d.splice(a,1,(0,n.__assign)((0,n.__assign)({},d[a]),e))}),null==s||s(d,o,!0),[3,7])):[3,8];case 1:if(void 0===r)return[3,6];m=0,p.label=2;case 2:return m<u?(c=d[m],[4,(0,l.JnN)(r,c)]):[3,5];case 3:p.sent()&&d.splice(m,1,(0,n.__assign)((0,n.__assign)({},d[m]),e)),p.label=4;case 4:return m++,[3,2];case 5:return null==s||s(d,o,!0),[3,7];case 6:null==s||s(e,o,!0),p.label=7;case 7:return[3,9];case 8:null==s||s(e,o,!0),p.label=9;case 9:return[2]}})})},(0,n.__decorate)([(0,l.eIh)({type:"combo",storeType:l.EaJ.name,extendsData:!1,shouldComponentUpdate:function(e,t){return(0,l.joH)(e.maxLength)&&(0,l.GvO)(t.maxLength,t.data)!==(0,l.GvO)(e.maxLength,e.data)||(0,l.joH)(e.minLength)&&(0,l.GvO)(t.minLength,t.data)!==(0,l.GvO)(e.minLength,e.data)}})],t)}(_),A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),(0,n.__decorate)([(0,l.eIh)({type:"input-kv",storeType:l.EaJ.name,extendsData:!1})],t)}(_),x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),(0,n.__decorate)([(0,l.eIh)({type:"input-kvs",storeType:l.EaJ.name,extendsData:!1})],t)}(_)}}]);