"use strict";(self.webpackChunkamis_editor_demo=self.webpackChunkamis_editor_demo||[]).push([[5403],{85403:function(e,t,a){a.r(t),a.d(t,{App:function(){return l},default:function(){return s}});var n=a(31635),r=a(96540),o=a(25627),i=a(5917),l=function(e){function t(t){var a,n,r,o=this;o=e.call(this,t)||this;var i=t.store;return i.syncProps(t,void 0,["pages"]),i.updateActivePage(Object.assign({},null!==(a=t.env)&&void 0!==a?a:{},{showFullBreadcrumbPath:null!==(n=t.showFullBreadcrumbPath)&&void 0!==n&&n,showBreadcrumbHomePath:null===(r=t.showBreadcrumbHomePath)||void 0===r||r})),t.env.watchRouteChange&&(o.unWatchRouteChange=t.env.watchRouteChange(function(){var e,a,n;return i.updateActivePage(Object.assign({},null!==(e=t.env)&&void 0!==e?e:{},{showFullBreadcrumbPath:null!==(a=t.showFullBreadcrumbPath)&&void 0!==a&&a,showBreadcrumbHomePath:null===(n=t.showBreadcrumbHomePath)||void 0===n||n}))})),o}return(0,n.__extends)(t,e),t.prototype.componentDidMount=function(){return(0,n.__awaiter)(this,void 0,void 0,function(){var e,t,a;return(0,n.__generator)(this,function(n){switch(n.label){case 0:return e=this.props,t=e.data,[4,(0,e.dispatchEvent)("init",t,this)];case 1:return(null==(a=n.sent())?void 0:a.prevented)||this.reload(),[2]}})})},t.prototype.componentDidUpdate=function(e){var t,a,r;return(0,n.__awaiter)(this,void 0,void 0,function(){var o,l;return(0,n.__generator)(this,function(n){return o=this.props,(l=o.store).syncProps(o,e,["pages"]),(0,i.B92)(e.api,o.api,e.data,o.data)?this.reload():o.location&&o.location!==e.location&&l.updateActivePage(Object.assign({},null!==(t=o.env)&&void 0!==t?t:{},{showFullBreadcrumbPath:null!==(a=o.showFullBreadcrumbPath)&&void 0!==a&&a,showBreadcrumbHomePath:null===(r=o.showBreadcrumbHomePath)||void 0===r||r})),[2]})})},t.prototype.componentWillUnmount=function(){var e;null===(e=this.unWatchRouteChange)||void 0===e||e.call(this)},t.prototype.reload=function(e,t,a,r,o){return(0,n.__awaiter)(this,void 0,void 0,function(){var e,a,r,l,s,c,d,u,p,h;return(0,n.__generator)(this,function(n){switch(n.label){case 0:return t?[2,this.receive(t,void 0,o)]:(e=this.props,a=e.api,r=e.store,l=e.env,s=e.showFullBreadcrumbPath,c=void 0!==s&&s,d=e.showBreadcrumbHomePath,u=void 0===d||d,p=e.locale,(0,i.Amo)(a,r.data)?[4,r.fetchInitData(a,r.data,{})]:[3,2]);case 1:h=n.sent(),l.replaceText&&(h.data=(0,i.eer)(h.data,l.replaceText,l.replaceTextIgnoreKeys)),(null==h?void 0:h.data.pages)&&(h.data=(0,i.Dzd)(h.data,p),r.setPages(h.data.pages),r.updateActivePage(Object.assign({},null!=l?l:{},{showFullBreadcrumbPath:c,showBreadcrumbHomePath:u}))),n.label=2;case 2:return[2,r.data]}})})},t.prototype.receive=function(e,t,a){return(0,n.__awaiter)(this,void 0,void 0,function(){return(0,n.__generator)(this,function(t){return this.props.store.updateData(e,void 0,a),[2,this.reload()]})})},t.prototype.resolveDefinitions=function(e){var t,a=this.props,n=a.resolveDefinitions,r=null===(t=a.store.schema)||void 0===t?void 0:t.definitions;return(null==r?void 0:r[e])||n(e)},t.prototype.handleNavClick=function(e){e.preventDefault();var t=this.props.env,a=e.currentTarget.getAttribute("href");t.jumpTo(a,void 0,this.props.data)},t.prototype.renderHeader=function(){var e=this.props,t=e.classnames,a=e.brandName,n=e.header,i=e.render,l=e.store,s=e.logo,c=e.env;return n||s||a?r.createElement(r.Fragment,null,r.createElement("div",{className:t("Layout-brandBar")},r.createElement("div",{onClick:l.toggleOffScreen,className:t("Layout-offScreenBtn")},r.createElement("i",{className:"bui-icon iconfont icon-collapse"})),r.createElement("div",{className:t("Layout-brand")},s&&~s.indexOf("<svg")?r.createElement(o.Ed,{className:t("AppLogo-html"),html:s,filterHtml:c.filterHtml}):s?r.createElement("img",{className:t("AppLogo"),src:s}):r.createElement("span",{className:"visible-folded "},null==a?void 0:a.substring(0,1)),r.createElement("span",{className:"hidden-folded m-l-sm"},a))),r.createElement("div",{className:t("Layout-headerBar")},r.createElement("a",{onClick:l.toggleFolded,type:"button",className:t("AppFoldBtn")},r.createElement("i",{className:"fa fa-".concat(l.folded?"indent":"dedent"," fa-fw")})),n?i("header",n):null)):null},t.prototype.renderAside=function(){var e=this,t=this.props,a=t.store,n=t.env,l=t.asideBefore,s=t.asideAfter,c=t.render,d=t.data;return r.createElement(r.Fragment,null,l?c("aside-before",l):null,r.createElement(o.ae,{navigations:a.navigations,renderLink:function(t,n){var l=t.link,s=(t.active,t.toggleExpand),c=t.classnames,u=t.depth,p=t.subHeader,h=[];if(!1===l.visible)return null;!p&&l.children&&l.children.some(function(e){return null==e?void 0:e.visible})&&h.push(r.createElement("span",{key:"expand-toggle",className:c("AsideNav-itemArrow"),onClick:function(e){return s(l,e)}}));var m="string"==typeof l.badge?(0,i.pbD)(l.badge,d):l.badge;return null!=m&&h.push(r.createElement("b",{key:"badge",className:c("AsideNav-itemBadge",l.badgeClassName||"bg-info")},m)),!p&&l.icon?h.push(r.createElement(o.In,{key:"icon",cx:c,icon:l.icon,className:"AsideNav-itemIcon"})):a.folded&&1===u&&!p&&h.push(r.createElement("i",{key:"icon",className:c("AsideNav-itemIcon",l.children?"fa fa-folder":"fa fa-info")})),h.push(r.createElement("span",{className:c("AsideNav-itemLabel"),key:"label"},"string"==typeof l.label?(0,i.pbD)(l.label,d):l.label)),l.path?/^https?\:/.test(l.path)?r.createElement("a",{target:"_blank",key:"link",href:l.path,rel:"noopener"},h):r.createElement("a",{key:"link",onClick:e.handleNavClick,href:l.path||l.children&&l.children[0].path},h):r.createElement("a",{key:"link",onClick:l.children?function(){return s(l)}:void 0},h)},isActive:function(e){return!!n.isCurrentUrl(null==e?void 0:e.path,e)}}),s?c("aside-before",s):null)},t.prototype.renderFooter=function(){var e=this.props,t=e.render,a=e.footer;return a?t("footer",a):null},t.prototype.render=function(){var e,t=this,a=this.props,n=a.classnames,i=a.store,l=a.render,s=a.showBreadcrumb,c=void 0===s||s,d=a.loadingConfig;return r.createElement(o.PE,{header:this.renderHeader(),aside:this.renderAside(),footer:this.renderFooter(),folded:i.folded,offScreen:i.offScreen,contentClassName:n("AppContent")},i.activePage&&i.schema?r.createElement(r.Fragment,null,c&&i.bcn.length?r.createElement("ul",{className:n("AppBcn")},i.bcn.map(function(e,a){return r.createElement("li",{key:a,className:n("AppBcn-item")},e.path?r.createElement("a",{href:e.path,onClick:t.handleNavClick},e.label):a!==i.bcn.length-1?r.createElement("a",null,e.label):e.label)})):null,r.createElement("div",{className:n("AppBody")},l("page",i.schema,{key:"".concat(null===(e=i.activePage)||void 0===e?void 0:e.id,"-").concat(i.schemaKey),data:i.pageData,resolveDefinitions:this.resolveDefinitions}))):i.pages&&!i.activePage?r.createElement(o.Mk,null,r.createElement("div",{className:"text-center"},"页面不存在")):null,r.createElement(o.y$,{loadingConfig:d,overlay:!0,show:i.loading||!i.pages,size:"lg"}))},t.propsList=["brandName","logo","header","asideBefore","asideAfter","pages","footer"],t.defaultProps={},(0,n.__decorate)([i.d6t,(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",[String]),(0,n.__metadata)("design:returntype",void 0)],t.prototype,"resolveDefinitions",null),(0,n.__decorate)([i.d6t,(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",[Object]),(0,n.__metadata)("design:returntype",void 0)],t.prototype,"handleNavClick",null),t}(r.Component),s=function(e){function t(t,a){var n=e.call(this,t)||this;return a.registerComponent(n),n}return(0,n.__extends)(t,e),t.prototype.componentWillUnmount=function(){this.context.unRegisterComponent(this),e.prototype.componentWillUnmount.call(this)},t.prototype.setData=function(e,t){return this.props.store.updateData(e,void 0,t)},t.prototype.getData=function(){return this.props.store.data},t.contextType=i.MzX,(0,n.__decorate)([(0,i.A49)({type:"app",storeType:i.two.name}),(0,n.__metadata)("design:paramtypes",[Object,Object])],t)}(l)}}]);