"use strict";(self.webpackChunkamis_editor_demo=self.webpackChunkamis_editor_demo||[]).push([[9794],{69794:function(e,t,n){n.r(t),n.d(t,{IconSelectControlRenderer:function(){return m},default:function(){return h}});var a=n(31635),o=n(96540),r=n(32485),l=n.n(r),i=n(51545),c=n(5917),s=n(25627),d=n(38221),p=n.n(d),u=n(23765),h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={activeTypeIndex:0,showModal:!1,tmpCheckIconId:null,searchValue:"",isRefreshLoading:!1},n.handleSearchValueChange=p()(n.handleSearchValueChange.bind(n),300),n}return(0,a.__extends)(t,e),t.prototype.getSvgName=function(e){var t;return"string"==typeof e?(null===(t=/data-name="(.*?)"/.exec(e))||void 0===t?void 0:t[1])||"":(null==e?void 0:e.name)||(null==e?void 0:e.id)||""},t.prototype.getSvgId=function(e){var t;return"string"==typeof e?(null===(t=/data-id="(.*?)"/.exec(e))||void 0===t?void 0:t[1])||"":(null==e?void 0:e.id)||""},t.prototype.getValueBySvg=function(e){var t;return e?"string"!=typeof e?(0,a.__assign)((0,a.__assign)({},e),{svg:null===(t=e.svg)||void 0===t?void 0:t.replace(/'/g,"")}):{name:this.getSvgName(e),id:this.getSvgId(e),svg:e.replace(/'/g,"")}:null},t.prototype.handleClick=function(){this.props.disabled||this.toggleModel(!0)},t.prototype.handleClear=function(e){e.preventDefault(),e.stopPropagation(),this.props.onChange&&this.props.onChange("")},t.prototype.renderInputArea=function(){var e=this.props,t=e.classPrefix,n=e.disabled,a=e.value,r=e.placeholder,i=e.clearable,c=this.getValueBySvg(a);return o.createElement("div",{className:l()("".concat(t,"IconSelectControl-input-area"))},o.createElement("div",{className:l()("".concat(t,"IconSelectControl-input-icon-show"))},o.createElement(s.In,{icon:null==c?void 0:c.svg,className:"icon"})),o.createElement("span",{className:l()("".concat(t,"IconSelectControl-input-icon-id"))},null==c?void 0:c.name),i&&!n&&c?o.createElement("a",{onClick:this.handleClear,className:l()("".concat(t,"IconSelectControl-clear"))},o.createElement(s.In,{icon:"input-clear",className:"icon"})):null,!c&&r&&o.createElement("span",{className:l()("".concat(t,"IconSelectControl-input-icon-placeholder"))},r)||null)},t.prototype.handleIconTypeClick=function(e,t){this.setState({activeTypeIndex:t})},t.prototype.renderIconTypes=function(){var e=this,t=this.props.classPrefix,n=u.svgIcons.map(function(e){return{id:e.groupId,label:e.name}});return o.createElement("ul",{className:l()("".concat(t,"IconSelectControl-type-list"))},n.map(function(t,n){return o.createElement("li",{key:t.id,onClick:function(){return e.handleIconTypeClick(t,n)},className:l()({active:n===e.state.activeTypeIndex})},t.label)}))},t.prototype.handleConfirm=function(){var e=this.state.tmpCheckIconId;if(this.props.returnSvg){var t=e&&e.svg||"";t=t.replace(/<svg/,'<svg data-name="'.concat(null==e?void 0:e.name,'" data-id="').concat(null==e?void 0:e.id,'"')),this.props.noSize&&(t=t.replace(/width=".*?"/,"").replace(/height=".*?"/,"")),this.props.onChange&&this.props.onChange(t)}else this.props.onChange&&this.props.onChange(e&&e.id?(0,a.__assign)((0,a.__assign)({},e),{id:"svg-"+e.id}):"");this.toggleModel(!1)},t.prototype.handleLocalUpload=function(e){return(0,a.__awaiter)(this,void 0,void 0,function(){return(0,a.__generator)(this,function(t){return this.props.onChange&&this.props.onChange(e),this.toggleModel(!1),[2]})})},t.prototype.handleClickIconInModal=function(e){var t;this.setState({tmpCheckIconId:(null==e?void 0:e.id)===(null===(t=this.state.tmpCheckIconId)||void 0===t?void 0:t.id)?null:e})},t.prototype.renderIconList=function(e){var t=this,n=this.props,a=n.classPrefix,r=n.noDataTip,i=n.translate;return e&&e.length?o.createElement("ul",{className:l()("".concat(a,"IconSelectControl-icon-list"))},e.map(function(e,n){var r;return o.createElement("li",{key:e.id},o.createElement("div",{className:l()("".concat(a,"IconSelectControl-icon-list-item"),{active:(null===(r=t.state.tmpCheckIconId)||void 0===r?void 0:r.id)===e.id}),onClick:function(){return t.handleClickIconInModal(e)}},o.createElement("svg",null,o.createElement("use",{xlinkHref:"#".concat(e.id)})),o.createElement("div",{className:l()("".concat(a,"IconSelectControl-icon-list-item-info"))},o.createElement("p",{className:l()("".concat(a,"IconSelectControl-icon-list-item-info-name"))},e.name))))})):o.createElement("p",{className:l()("".concat(a,"IconSelectControl-icon-list-empty"))},i(r))},t.prototype.handleSearchValueChange=function(e){this.setState({searchValue:e})},t.prototype.handleRefreshIconList=function(){return(0,a.__awaiter)(this,void 0,void 0,function(){var e,t;return(0,a.__generator)(this,function(n){switch(n.label){case 0:if(!(e=u.refreshIconList)||"function"!=typeof e)return[3,5];n.label=1;case 1:return n.trys.push([1,3,4,5]),this.setState({isRefreshLoading:!0}),[4,Promise.resolve(e())];case 2:return n.sent(),[3,5];case 3:return t=n.sent(),console.error(t),[3,5];case 4:return this.setState({isRefreshLoading:!1}),[7];case 5:return[2]}})})},t.prototype.renderModalContent=function(){var e=this.props,t=e.render,n=e.classPrefix,a=e.loadingConfig,r=(e.funcSchema,e.funcCom),c=this.getIconsByType(),d=this.state.searchValue,p=d?(0,i.matchSorter)(c,d,{keys:["name"],threshold:i.matchSorter.rankings.CONTAINS}):c;return o.createElement(o.Fragment,null,o.createElement(s.Gd,{className:l()("".concat(n,"IconSelectControl-Modal-search")),mini:!1,clearable:!0,onChange:this.handleSearchValueChange}),u.refreshIconList&&t("refresh-btn",{type:"button",icon:"fa fa-refresh"},{className:l()("".concat(n,"IconSelectControl-Modal-refresh")),onClick:this.handleRefreshIconList})||null,r?o.createElement("div",{className:l()("".concat(n,"IconSelectControl-Modal-func"))},o.createElement(r,{onUpload:this.handleLocalUpload})):null,o.createElement("div",{className:l()("".concat(n,"IconSelectControl-Modal-content"))},o.createElement(s.y$,{size:"lg",loadingConfig:a,overlay:!0,key:"info",show:this.state.isRefreshLoading}),o.createElement("div",{className:l()("".concat(n,"IconSelectControl-Modal-content-aside"))},this.renderIconTypes()),o.createElement("div",{className:l()("".concat(n,"IconSelectControl-Modal-content-main"))},this.renderIconList(p))))},t.prototype.getIconsByType=function(){return(null==u?void 0:u.svgIcons.length)&&u.svgIcons[this.state.activeTypeIndex].children||[]},t.prototype.toggleModel=function(e){var t=this.props.value,n="string"==typeof t?this.getValueBySvg(t):t;void 0!==e?this.setState({showModal:e,tmpCheckIconId:e&&(null==n?void 0:n.id)?(0,a.__assign)((0,a.__assign)({},n),{id:String(n.id).replace(/^svg-/,"")}):null,searchValue:""}):this.setState({showModal:!this.state.showModal,searchValue:""})},t.prototype.render=function(){var e=this,t=this.props,n=t.className,a=(t.style,t.classPrefix),r=t.disabled,i=t.translate;return o.createElement("div",{className:l()(n,"".concat(a,"IconSelectControl"),{"is-focused":this.state.showModal,"is-disabled":r})},o.createElement("div",{className:l()("".concat(a,"IconSelectControl-input")),onClick:this.handleClick},this.renderInputArea()),o.createElement(s.aF,{show:this.state.showModal,closeOnOutside:!0,closeOnEsc:!0,size:"lg",overlay:!0,onHide:function(){return e.toggleModel(!1)}},o.createElement(s.aF.Header,{onClose:function(){return e.toggleModel(!1)}},i("IconSelect.choice")),o.createElement(s.aF.Body,null,this.renderModalContent()),o.createElement(s.aF.Footer,null,o.createElement(s.$n,{type:"button",className:"m-l",onClick:function(){return e.toggleModel(!1)}},i("cancel")),o.createElement(s.$n,{type:"button",level:"primary",onClick:this.handleConfirm},i("confirm")))))},t.defaultProps={noDataTip:"placeholder.noData",clearable:!0},(0,a.__decorate)([c.d6t,(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[]),(0,a.__metadata)("design:returntype",void 0)],t.prototype,"handleClick",null),(0,a.__decorate)([c.d6t,(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object]),(0,a.__metadata)("design:returntype",void 0)],t.prototype,"handleClear",null),(0,a.__decorate)([c.d6t,(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[]),(0,a.__metadata)("design:returntype",void 0)],t.prototype,"renderInputArea",null),(0,a.__decorate)([c.d6t,(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Object,Number]),(0,a.__metadata)("design:returntype",void 0)],t.prototype,"handleIconTypeClick",null),(0,a.__decorate)([c.d6t,(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[]),(0,a.__metadata)("design:returntype",void 0)],t.prototype,"renderIconTypes",null),(0,a.__decorate)([c.d6t,(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[]),(0,a.__metadata)("design:returntype",void 0)],t.prototype,"handleConfirm",null),(0,a.__decorate)([c.d6t,(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[String]),(0,a.__metadata)("design:returntype",Promise)],t.prototype,"handleLocalUpload",null),(0,a.__decorate)([c.d6t,(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Array]),(0,a.__metadata)("design:returntype",void 0)],t.prototype,"renderIconList",null),(0,a.__decorate)([c.d6t,(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[]),(0,a.__metadata)("design:returntype",Promise)],t.prototype,"handleRefreshIconList",null),(0,a.__decorate)([c.d6t,(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[]),(0,a.__metadata)("design:returntype",void 0)],t.prototype,"renderModalContent",null),(0,a.__decorate)([c.d6t,(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Boolean]),(0,a.__metadata)("design:returntype",void 0)],t.prototype,"toggleModel",null),t}(o.PureComponent),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),(0,a.__decorate)([(0,c.eIh)({type:"icon-select"})],t)}(h)}}]);